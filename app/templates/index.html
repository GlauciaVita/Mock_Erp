<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mock ERP - Dashboard</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .card {
            background-color: #f9f9f9;
            padding: 15px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
            position: relative;
        }
        .user-card {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        .user-info {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 20px;
            align-items: center;
        }
        .current-user {
            display: flex;
            flex-direction: column;
        }
        .current-user span:first-child {
            font-weight: bold;
            font-size: 16px;
            color: #333;
        }
        .user-email {
            font-size: 14px;
            color: #666;
            margin-top: 2px;
        }
        .user-selector {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .user-selector label {
            font-size: 12px;
            color: #666;
            font-weight: normal;
        }
        .user-selector select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            min-width: 150px;
        }
        .user-status {
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #28a745;
            border-radius: 50%;
            margin-right: 8px;
        }
        .virtual-assistant {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: white;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        .virtual-assistant:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #0056b3;
        }
        .product-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .product-form .full-width {
            grid-column: 1 / -1;
        }
        .form-group {
            display: flex;
            flex-direction: column;
        }
        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #333;
        }
        .form-group input, .form-group textarea, .form-group select {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }
        .image-preview {
            width: 100px;
            height: 100px;
            border: 2px dashed #ddd;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: #f9f9f9;
            margin-top: 5px;
        }
        .image-preview img {
            max-width: 90px;
            max-height: 90px;
            border-radius: 4px;
        }
        .product-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        .product-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            transition: background-color 0.3s;
        }
        .btn-electronics {
            background-color: #28a745;
            color: white;
        }
        .btn-electronics:hover {
            background-color: #218838;
        }
        .btn-clothing {
            background-color: #ffc107;
            color: #333;
        }
        .btn-clothing:hover {
            background-color: #e0a800;
        }
        .btn-books {
            background-color: #6f42c1;
            color: white;
        }
        .btn-books:hover {
            background-color: #5a359b;
        }
        .btn-home {
            background-color: #fd7e14;
            color: white;
        }
        .btn-home:hover {
            background-color: #e8650e;
        }
        .btn-sports {
            background-color: #20c997;
            color: white;
        }
        .btn-sports:hover {
            background-color: #1ba085;
        }
        .btn-beauty {
            background-color: #e83e8c;
            color: white;
        }
        .btn-beauty:hover {
            background-color: #d91a72;
        }
        
        /* Sistema de Abas */
        .tab-system {
            margin-top: 15px;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 2px solid #e9ecef;
            margin-bottom: 20px;
        }
        
        .tab-btn {
            padding: 12px 20px;
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s ease;
            flex: 1;
        }
        
        .tab-btn:hover {
            color: #007bff;
            background-color: #f8f9fa;
        }
        
        .tab-btn.active {
            color: #007bff;
            border-bottom-color: #007bff;
            background-color: #ffffff;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        /* Lista de itens */
        .items-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #e9ecef;
            border-radius: 6px;
        }
        
        .item-row {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid #f8f9fa;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .item-row:hover {
            background-color: #f8f9fa;
        }
        
        .item-row.selected {
            background-color: #e3f2fd;
            border-left: 4px solid #007bff;
        }
        
        .item-row:last-child {
            border-bottom: none;
        }
        
        .item-info {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .item-name {
            font-weight: 500;
            color: #333;
            margin-bottom: 2px;
        }
        
        .item-details {
            font-size: 12px;
            color: #6c757d;
        }
        
        .item-status {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
            margin-left: 10px;
        }
        
        .status-active {
            color: #28a745;
        }
        
        .status-inactive {
            color: #dc3545;
        }
        
        /* Dialog do Assistente Virtual */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .dialog-content {
            background: white;
            border-radius: 12px;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
        }
        
        .dialog-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .dialog-header h3 {
            margin: 0;
            color: #333;
            flex: 1;
        }
        
        .close-dialog {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .close-dialog:hover {
            color: #333;
            background-color: #f0f0f0;
            border-radius: 50%;
        }
        
        .product-info {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }
        
        .product-info h4 {
            margin: 0 0 10px 0;
            color: #333;
        }
        
        .product-info p {
            margin: 5px 0;
            font-size: 14px;
            color: #666;
        }
        
        .question-area {
            margin-bottom: 20px;
        }
        
        .question-area label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #333;
        }
        
        .question-area textarea {
            width: 100%;
            min-height: 100px;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            box-sizing: border-box;
        }
        
        .dialog-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .btn-send {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .btn-send:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-cancel {
            background: #6c757d;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }
        
        .btn-cancel:hover {
            background: #5a6268;
        }
        
        /* √Årea de resposta do assistente */
        .response-area {
            display: none;
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
        }
        
        .response-area.show {
            display: block;
        }
        
        .response-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }
        
        .response-content {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border-left: 4px solid #28a745;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .response-meta {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
            font-size: 12px;
            color: #666;
        }
        
        .meta-item {
            background: white;
            padding: 8px;
            border-radius: 4px;
            text-align: center;
        }
        
        /* Sistema de avalia√ß√£o com estrelas */
        .rating-section {
            background: white;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }
        
        .rating-title {
            margin: 0 0 10px 0;
            font-size: 14px;
            font-weight: bold;
            color: #333;
        }
        
        .star-rating {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
        }
        
        .star {
            font-size: 24px;
            color: #ddd;
            cursor: pointer;
            transition: color 0.2s, transform 0.1s;
            user-select: none;
            display: inline-block;
        }
        
        .star:hover {
            color: #ffc107;
            transform: scale(1.1);
        }
        
        .star.selected {
            color: #ffc107;
        }
        
        .star.temp-highlight {
            color: #ffc107;
        }
        
        .rating-feedback {
            display: none;
            margin-top: 10px;
        }
        
        .rating-feedback.show {
            display: block;
        }
        
        .feedback-text {
            width: 100%;
            min-height: 60px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 12px;
            margin-bottom: 10px;
            box-sizing: border-box;
            resize: vertical;
        }
        
        .rating-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }
        
        .btn-rating {
            padding: 6px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .btn-submit-rating {
            background: #28a745;
            color: white;
        }
        
        .btn-submit-rating:hover {
            background: #218838;
        }
        
        .btn-skip-rating {
            background: #6c757d;
            color: white;
        }
        
        .btn-skip-rating:hover {
            background: #5a6268;
        }
        
        /* Loading state */
        .loading-spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Menu de navega√ß√£o */
        .navigation-menu {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 8px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        
        .menu-title {
            color: white;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .menu-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 12px;
        }
        
        .menu-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .menu-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.5);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        
        .menu-btn:active {
            transform: translateY(0);
        }
        
        .menu-btn.coming-soon {
            position: relative;
            overflow: hidden;
        }
        
        .menu-btn.coming-soon::after {
            content: "Em breve";
            position: absolute;
            top: 2px;
            right: 4px;
            background: #ffc107;
            color: #333;
            font-size: 8px;
            padding: 1px 4px;
            border-radius: 2px;
            font-weight: bold;
        }
        
        /* Responsividade para o menu */
        @media (max-width: 768px) {
            .menu-buttons {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .menu-buttons {
                grid-template-columns: 1fr;
            }
        }
        
        /* Estilos para os cards dos m√≥dulos */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .form-grid .form-group.full-width {
            grid-column: 1 / -1;
        }
        
        .action-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.4);
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(108, 117, 125, 0.4);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #333;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-warning:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 193, 7, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(220, 53, 69, 0.4);
        }
        
        .btn-info {
            background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .btn-info:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(23, 162, 184, 0.4);
        }
        
        /* Anima√ß√£o de entrada dos cards */
        .card {
            transition: all 0.3s ease;
        }
        
        .card.show {
            display: block !important;
            animation: fadeInUp 0.4s ease-out;
        }
        
        .card.hide {
            animation: fadeOut 0.3s ease-in;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-20px);
            }
        }
        
        /* Responsividade para formul√°rios */
        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
            
            .action-buttons button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Mock ERP - Sistema de Gest√£o</h1>
        
        <!-- Card de Usu√°rio Conectado -->
        <div class="card user-card">
            <h3>üë§ Usu√°rio Conectado</h3>
            <div class="user-info">
                <div class="current-user">
                    <span id="currentUserName">Selecione um usu√°rio</span>
                    <span id="currentUserEmail" class="user-email"></span>
                </div>
                <div class="user-selector">
                    <label for="userSelect">Selecionar usu√°rio:</label>
                    <select id="userSelect" onchange="selectUser()">
                        <option value="">-- Selecione --</option>
                    </select>
                </div>
            </div>
        </div>
        
        <!-- Menu de Navega√ß√£o -->
        <div class="navigation-menu">
            <div class="menu-title">üìã Menu Principal</div>
            <div class="menu-buttons">
                <button class="menu-btn" onclick="navigateTo('clientes')">
                    üë• Clientes
                </button>
                <button class="menu-btn" onclick="navigateTo('produtos')">
                    üì¶ Produtos
                </button>
                <button class="menu-btn" onclick="navigateTo('vendas')">
                    üí∞ Vendas
                </button>
                <button class="menu-btn" onclick="navigateTo('transportadoras')">
                    üöö Transportadoras
                </button>
                <button class="menu-btn" onclick="navigateTo('notas-fiscais')">
                    üìÑ Notas Fiscais
                </button>
                <button class="menu-btn" onclick="navigateTo('usuarios')">
                    üë§ Usu√°rios
                </button>
                <button class="menu-btn" onclick="navigateTo('empresa')">
                    üè¢ Empresa
                </button>
            </div>
        </div>
        
        <!-- Card de Clientes -->
        <div class="card" id="clientesCard" style="display: none;">
            <button class="virtual-assistant" title="Assistente Virtual - Clientes" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üë• Gest√£o de Clientes</h3>
            <p>Cadastro e gerenciamento de clientes do sistema:</p>
            
            <!-- Sistema de Abas -->
            <div class="tab-system">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchClienteTab('listagem')">
                        üìã Listagem
                    </button>
                    <button class="tab-btn" onclick="switchClienteTab('cadastro')">
                        ‚ûï Cadastro/Edi√ß√£o
                    </button>
                </div>
                
                <!-- Aba Listagem -->
                <div class="tab-content active" id="clienteListagem">
                    <div class="items-list" id="clientesList">
                        <!-- Lista ser√° preenchida via JavaScript -->
                    </div>
                </div>
                
                <!-- Aba Cadastro -->
                <div class="tab-content" id="clienteCadastro">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="clienteNome">Nome/Raz√£o Social:</label>
                            <input type="text" id="clienteNome" placeholder="Ex: Jo√£o Silva Ltda.">
                        </div>
                        
                        <div class="form-group">
                            <label for="clienteTipo">Tipo:</label>
                            <select id="clienteTipo">
                                <option value="">Selecione o tipo</option>
                                <option value="pf">Pessoa F√≠sica</option>
                                <option value="pj">Pessoa Jur√≠dica</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="clienteDocumento">CPF/CNPJ:</label>
                            <input type="text" id="clienteDocumento" placeholder="Ex: 12.345.678/0001-90">
                        </div>
                        
                        <div class="form-group">
                            <label for="clienteEmail">E-mail:</label>
                            <input type="email" id="clienteEmail" placeholder="Ex: cliente@email.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="clienteTelefone">Telefone:</label>
                            <input type="tel" id="clienteTelefone" placeholder="Ex: (11) 99999-9999">
                        </div>
                        
                        <div class="form-group">
                            <label for="clienteCep">CEP:</label>
                            <input type="text" id="clienteCep" placeholder="Ex: 01234-567">
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="clienteEndereco">Endere√ßo Completo:</label>
                            <textarea id="clienteEndereco" placeholder="Rua, n√∫mero, bairro, cidade, estado..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarCliente()">üíæ Salvar Cliente</button>
                <button class="btn-secondary" onclick="novoCliente()">‚ûï Novo Cliente</button>
                <button class="btn-danger" onclick="limparFormCliente()">üóëÔ∏è Limpar Formul√°rio</button>
            </div>
        </div>
        
        <!-- Card de Vendas -->
        <div class="card" id="vendasCard" style="display: none;">
            <button class="virtual-assistant" title="Assistente Virtual - Vendas" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üí∞ Gest√£o de Vendas</h3>
            <p>Registro e controle de vendas:</p>
            
            <!-- Sistema de Abas -->
            <div class="tab-system">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchVendaTab('listagem')">
                        üìã Listagem
                    </button>
                    <button class="tab-btn" onclick="switchVendaTab('cadastro')">
                        ‚ûï Cadastro/Edi√ß√£o
                    </button>
                </div>
                
                <!-- Aba Listagem -->
                <div class="tab-content active" id="vendaListagem">
                    <div class="items-list" id="vendasList">
                        <!-- Lista ser√° preenchida via JavaScript -->
                    </div>
                </div>
                
                <!-- Aba Cadastro -->
                <div class="tab-content" id="vendaCadastro">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="vendaNumero">N√∫mero da Venda:</label>
                            <input type="text" id="vendaNumero" placeholder="Ex: VEN001" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="vendaCliente">Cliente:</label>
                            <select id="vendaCliente">
                                <option value="">Selecione o cliente</option>
                                <option value="1">Jo√£o Silva Ltda.</option>
                                <option value="2">Maria Santos</option>
                                <option value="3">Empresa ABC S.A.</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="vendaData">Data da Venda:</label>
                            <input type="date" id="vendaData">
                        </div>
                        
                        <div class="form-group">
                            <label for="vendaVendedor">Vendedor:</label>
                            <select id="vendaVendedor">
                                <option value="">Selecione o vendedor</option>
                                <option value="1">Carlos Vendas</option>
                                <option value="2">Ana Comercial</option>
                                <option value="3">Pedro Neg√≥cios</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="vendaFormaPagamento">Forma de Pagamento:</label>
                            <select id="vendaFormaPagamento">
                                <option value="">Selecione a forma</option>
                                <option value="dinheiro">Dinheiro</option>
                                <option value="cartao">Cart√£o de Cr√©dito</option>
                                <option value="pix">PIX</option>
                                <option value="boleto">Boleto</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="vendaTotal">Valor Total:</label>
                            <input type="number" id="vendaTotal" placeholder="0,00" step="0.01" readonly>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="vendaObservacoes">Observa√ß√µes:</label>
                            <textarea id="vendaObservacoes" placeholder="Informa√ß√µes adicionais sobre a venda..."></textarea>
                        </div>
                        
                        <!-- Se√ß√£o de Produtos da Venda -->
                        <div class="form-group full-width">
                            <h4 style="margin: 20px 0 10px 0; color: #495057;">üõí Produtos da Venda</h4>
                            <div class="produtos-venda">
                                <div class="produto-selector">
                                    <label for="vendaProduto">Adicionar Produto:</label>
                                    <select id="vendaProduto">
                                        <option value="">Selecione um produto</option>
                                        <option value="1">Smartphone Samsung Galaxy A54</option>
                                        <option value="2">Camiseta Polo Masculina</option>
                                        <option value="3">Clean Code - C√≥digo Limpo</option>
                                        <option value="4">Aspirador de P√≥ Vertical</option>
                                        <option value="5">Bola de Futebol Oficial</option>
                                        <option value="6">Kit Maquiagem Completo</option>
                                    </select>
                                    <input type="number" id="vendaQuantidade" placeholder="Qtd" min="1" value="1" style="width: 80px; margin-left: 10px;">
                                    <input type="number" id="vendaPrecoUnitario" placeholder="Pre√ßo" step="0.01" style="width: 100px; margin-left: 10px;">
                                    <button type="button" onclick="adicionarProdutoVenda()" style="margin-left: 10px; padding: 5px 10px; background: #28a745; color: white; border: none; border-radius: 4px;">‚ûï Adicionar</button>
                                </div>
                                <div class="produtos-lista" id="produtosVendaLista">
                                    <!-- Lista de produtos ser√° preenchida via JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarVenda()">üíæ Salvar Venda</button>
                <button class="btn-secondary" onclick="novaVenda()">‚ûï Nova Venda</button>
                <button class="btn-danger" onclick="limparFormVenda()">üóëÔ∏è Limpar Formul√°rio</button>
            </div>
        </div>
        
        <!-- Card de Transportadoras -->
        <div class="card" id="transportadorasCard" style="display: none;">
            <button class="virtual-assistant" title="Assistente Virtual - Transportadoras" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üöö Gest√£o de Transportadoras</h3>
            <p>Cadastro e controle de empresas de transporte:</p>
            
            <!-- Sistema de Abas -->
            <div class="tab-system">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchTransportadoraTab('listagem')">
                        üìã Listagem
                    </button>
                    <button class="tab-btn" onclick="switchTransportadoraTab('cadastro')">
                        ‚ûï Cadastro/Edi√ß√£o
                    </button>
                </div>
                
                <!-- Aba Listagem -->
                <div class="tab-content active" id="transportadoraListagem">
                    <div class="items-list" id="transportadorasList">
                        <!-- Lista ser√° preenchida via JavaScript -->
                    </div>
                </div>
                
                <!-- Aba Cadastro -->
                <div class="tab-content" id="transportadoraCadastro">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="transpNome">Nome da Transportadora:</label>
                            <input type="text" id="transpNome" placeholder="Ex: Transportes R√°pidos Ltda.">
                        </div>
                        
                        <div class="form-group">
                            <label for="transpCnpj">CNPJ:</label>
                            <input type="text" id="transpCnpj" placeholder="Ex: 12.345.678/0001-90">
                        </div>
                        
                        <div class="form-group">
                            <label for="transpContato">Contato:</label>
                            <input type="text" id="transpContato" placeholder="Ex: Jos√© Silva">
                        </div>
                        
                        <div class="form-group">
                            <label for="transpTelefone">Telefone:</label>
                            <input type="tel" id="transpTelefone" placeholder="Ex: (11) 3333-4444">
                        </div>
                        
                        <div class="form-group">
                            <label for="transpEmail">E-mail:</label>
                            <input type="email" id="transpEmail" placeholder="Ex: contato@transportadora.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="transpRegiao">Regi√£o de Atua√ß√£o:</label>
                            <select id="transpRegiao">
                                <option value="">Selecione a regi√£o</option>
                                <option value="local">Local (mesma cidade)</option>
                                <option value="regional">Regional (mesmo estado)</option>
                                <option value="nacional">Nacional</option>
                                <option value="internacional">Internacional</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="transpObservacoes">Observa√ß√µes:</label>
                            <textarea id="transpObservacoes" placeholder="Informa√ß√µes sobre prazos, especialidades, restri√ß√µes..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarTransportadora()">üíæ Salvar Transportadora</button>
                <button class="btn-secondary" onclick="novaTransportadora()">‚ûï Nova Transportadora</button>
                <button class="btn-danger" onclick="limparFormTransportadora()">ÔøΩÔ∏è Limpar Formul√°rio</button>
            </div>
        </div>
        
        <!-- Card de Notas Fiscais -->
        <div class="card" id="notasFiscaisCard" style="display: none;">
            <button class="virtual-assistant" title="Assistente Virtual - Notas Fiscais" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üìÑ Gest√£o de Notas Fiscais</h3>
            <p>Emiss√£o e controle de documentos fiscais:</p>
            
            <!-- Sistema de Abas -->
            <div class="tab-system">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchNotaFiscalTab('listagem')">
                        üìã Listagem
                    </button>
                    <button class="tab-btn" onclick="switchNotaFiscalTab('cadastro')">
                        ‚ûï Cadastro/Edi√ß√£o
                    </button>
                </div>
                
                <!-- Aba Listagem -->
                <div class="tab-content active" id="notaFiscalListagem">
                    <div class="items-list" id="notasFiscaisList">
                        <!-- Lista ser√° preenchida via JavaScript -->
                    </div>
                </div>
                
                <!-- Aba Cadastro -->
                <div class="tab-content" id="notaFiscalCadastro">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="nfNumero">N√∫mero da NF:</label>
                            <input type="text" id="nfNumero" placeholder="Ex: 000001" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="nfSerie">S√©rie:</label>
                            <input type="text" id="nfSerie" placeholder="Ex: 1" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="nfTipo">Tipo de NF:</label>
                            <select id="nfTipo">
                                <option value="">Selecione o tipo</option>
                                <option value="nfe">NF-e (Eletr√¥nica)</option>
                                <option value="nfce">NFC-e (Consumidor)</option>
                                <option value="nfse">NFS-e (Servi√ßos)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="nfOperacao">Opera√ß√£o:</label>
                            <select id="nfOperacao">
                                <option value="">Selecione a opera√ß√£o</option>
                                <option value="venda">Venda</option>
                                <option value="devolucao">Devolu√ß√£o</option>
                                <option value="transferencia">Transfer√™ncia</option>
                                <option value="servico">Presta√ß√£o de Servi√ßo</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="nfCliente">Cliente/Destinat√°rio:</label>
                            <select id="nfCliente">
                                <option value="">Selecione o cliente</option>
                                <option value="1">Jo√£o Silva Ltda.</option>
                                <option value="2">Maria Santos</option>
                                <option value="3">Empresa ABC S.A.</option>
                                <option value="4">Carlos Oliveira</option>
                                <option value="5">TechSoft Solu√ß√µes Ltda.</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="nfDataEmissao">Data de Emiss√£o:</label>
                            <input type="date" id="nfDataEmissao">
                        </div>
                        
                        <div class="form-group">
                            <label for="nfValor">Valor Total:</label>
                            <input type="number" id="nfValor" placeholder="0,00" step="0.01" readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="nfStatus">Status:</label>
                            <select id="nfStatus">
                                <option value="">Selecione o status</option>
                                <option value="rascunho">Rascunho</option>
                                <option value="autorizada">Autorizada</option>
                                <option value="cancelada">Cancelada</option>
                                <option value="inutilizada">Inutilizada</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="nfObservacoes">Observa√ß√µes da NF:</label>
                            <textarea id="nfObservacoes" placeholder="Informa√ß√µes fiscais complementares..."></textarea>
                        </div>
                        
                        <!-- Se√ß√£o de Produtos da Nota Fiscal -->
                        <div class="form-group full-width">
                            <h4 style="margin: 20px 0 10px 0; color: #495057;">üì¶ Produtos da Nota Fiscal</h4>
                            <div class="produtos-nf">
                                <div class="produto-selector">
                                    <label for="nfProduto">Adicionar Produto:</label>
                                    <select id="nfProduto">
                                        <option value="">Selecione um produto</option>
                                        <option value="1">Smartphone Samsung Galaxy A54</option>
                                        <option value="2">Camiseta Polo Masculina</option>
                                        <option value="3">Clean Code - C√≥digo Limpo</option>
                                        <option value="4">Aspirador de P√≥ Vertical</option>
                                        <option value="5">Bola de Futebol Oficial</option>
                                        <option value="6">Kit Maquiagem Completo</option>
                                    </select>
                                    <input type="number" id="nfQuantidade" placeholder="Qtd" min="1" value="1" style="width: 80px; margin-left: 10px;">
                                    <input type="number" id="nfPrecoUnitario" placeholder="Pre√ßo" step="0.01" style="width: 100px; margin-left: 10px;">
                                    <button type="button" onclick="adicionarProdutoNF()" style="margin-left: 10px; padding: 5px 10px; background: #28a745; color: white; border: none; border-radius: 4px;">‚ûï Adicionar</button>
                                </div>
                                <div class="produtos-lista" id="produtosNFLista">
                                    <!-- Lista de produtos ser√° preenchida via JavaScript -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarNotaFiscal()">ÔøΩ Salvar Nota Fiscal</button>
                <button class="btn-secondary" onclick="novaNotaFiscal()">‚ûï Nova Nota Fiscal</button>
                <button class="btn-danger" onclick="limparFormNotaFiscal()">üóëÔ∏è Limpar Formul√°rio</button>
            </div>
        </div>
        
        <!-- Card de Usu√°rios -->
        <div class="card" id="usuariosCard" style="display: none;">
            <button class="virtual-assistant" title="Assistente Virtual - Usu√°rios" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üë§ Gest√£o de Usu√°rios</h3>
            <p>Controle de acesso e permiss√µes do sistema:</p>
            
            <!-- Sistema de Abas -->
            <div class="tab-system">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchUsuarioTab('listagem')">
                        üìã Listagem
                    </button>
                    <button class="tab-btn" onclick="switchUsuarioTab('cadastro')">
                        ‚ûï Cadastro/Edi√ß√£o
                    </button>
                </div>
                
                <!-- Aba Listagem -->
                <div class="tab-content active" id="usuarioListagem">
                    <div class="items-list" id="usuariosList">
                        <!-- Lista ser√° preenchida via JavaScript -->
                    </div>
                </div>
                
                <!-- Aba Cadastro -->
                <div class="tab-content" id="usuarioCadastro">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="usuarioNome">Nome Completo:</label>
                            <input type="text" id="usuarioNome" placeholder="Ex: Ana Silva Santos">
                        </div>
                        
                        <div class="form-group">
                            <label for="usuarioLogin">Login/Usu√°rio:</label>
                            <input type="text" id="usuarioLogin" placeholder="Ex: ana.silva">
                        </div>
                        
                        <div class="form-group">
                            <label for="usuarioEmail">E-mail:</label>
                            <input type="email" id="usuarioEmail" placeholder="Ex: ana@empresa.com">
                        </div>
                        
                        <div class="form-group">
                            <label for="usuarioSenha">Senha:</label>
                            <input type="password" id="usuarioSenha" placeholder="Digite a senha">
                        </div>
                        
                        <div class="form-group">
                            <label for="usuarioPerfil">Perfil de Acesso:</label>
                            <select id="usuarioPerfil">
                                <option value="">Selecione o perfil</option>
                                <option value="admin">Administrador</option>
                                <option value="vendedor">Vendedor</option>
                                <option value="operador">Operador</option>
                                <option value="consulta">Apenas Consulta</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="usuarioStatus">Status:</label>
                            <select id="usuarioStatus">
                                <option value="">Selecione o status</option>
                                <option value="ativo">Ativo</option>
                                <option value="inativo">Inativo</option>
                                <option value="bloqueado">Bloqueado</option>
                            </select>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="usuarioObservacoes">Observa√ß√µes:</label>
                            <textarea id="usuarioObservacoes" placeholder="Informa√ß√µes adicionais sobre o usu√°rio..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarUsuario()">üíæ Salvar Usu√°rio</button>
                <button class="btn-secondary" onclick="novoUsuario()">‚ûï Novo Usu√°rio</button>
                <button class="btn-danger" onclick="limparFormUsuario()">ÔøΩÔ∏è Limpar Formul√°rio</button>
            </div>
        </div>
        
        <!-- Card de Empresa -->
        <div class="card" id="empresaCard" style="display: none;">
            <button class="virtual-assistant" title="Assistente Virtual - Empresa" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üè¢ Dados da Empresa</h3>
            <p>Configura√ß√µes e informa√ß√µes da empresa:</p>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="empresaNome">Raz√£o Social:</label>
                    <input type="text" id="empresaNome" placeholder="Ex: Minha Empresa Ltda.">
                </div>
                
                <div class="form-group">
                    <label for="empresaFantasia">Nome Fantasia:</label>
                    <input type="text" id="empresaFantasia" placeholder="Ex: Minha Loja">
                </div>
                
                <div class="form-group">
                    <label for="empresaCnpj">CNPJ:</label>
                    <input type="text" id="empresaCnpj" placeholder="Ex: 12.345.678/0001-90">
                </div>
                
                <div class="form-group">
                    <label for="empresaIE">Inscri√ß√£o Estadual:</label>
                    <input type="text" id="empresaIE" placeholder="Ex: 123.456.789.012">
                </div>
                
                <div class="form-group">
                    <label for="empresaTelefone">Telefone:</label>
                    <input type="tel" id="empresaTelefone" placeholder="Ex: (11) 3333-4444">
                </div>
                
                <div class="form-group">
                    <label for="empresaEmail">E-mail:</label>
                    <input type="email" id="empresaEmail" placeholder="Ex: contato@minhaempresa.com">
                </div>
                
                <div class="form-group full-width">
                    <label for="empresaEndereco">Endere√ßo Completo:</label>
                    <textarea id="empresaEndereco" placeholder="Rua, n√∫mero, bairro, cidade, estado, CEP..."></textarea>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarEmpresa()">üíæ Salvar Dados</button>
                <button class="btn-secondary" onclick="consultarCNPJ()">üîç Consultar CNPJ</button>
                <button class="btn-info" onclick="gerarRelatorio()">üìä Gerar Relat√≥rio</button>
            </div>
        </div>
        
        <div class="card" id="produtosCard">
            <button class="virtual-assistant" title="Assistente Virtual" onclick="openAssistantDialog()">
                ü§ñ
            </button>
            <h3>üì¶ Gest√£o de Produtos</h3>
            <p>Cadastro e gerenciamento de produtos do sistema:</p>
            
            <!-- Sistema de Abas -->
            <div class="tab-system">
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="switchProductTab('listagem')">
                        üìã Listagem
                    </button>
                    <button class="tab-btn" onclick="switchProductTab('cadastro')">
                        ‚ûï Cadastro/Edi√ß√£o
                    </button>
                </div>
                
                <!-- Aba Listagem -->
                <div class="tab-content active" id="productListagem">
                    <div class="items-list" id="productsList">
                        <!-- Lista ser√° preenchida via JavaScript -->
                    </div>
                </div>
                
                <!-- Aba Cadastro -->
                <div class="tab-content" id="productCadastro">
                    <div class="product-form">
                        <div class="form-group">
                            <label for="productCode">C√≥digo do Produto:</label>
                            <input type="text" id="productCode" placeholder="Ex: PRD001">
                        </div>
                        
                        <div class="form-group">
                            <label for="productName">Nome do Produto:</label>
                            <input type="text" id="productName" placeholder="Ex: Smartphone Samsung">
                        </div>
                        
                        <div class="form-group">
                            <label for="productEan">EAN:</label>
                            <input type="text" id="productEan" placeholder="Ex: 7891234567890">
                        </div>
                        
                        <div class="form-group">
                            <label for="productRef">Refer√™ncia:</label>
                            <input type="text" id="productRef" placeholder="Ex: SM-A125F">
                        </div>
                        
                        <div class="form-group">
                            <label for="productQty">Quantidade:</label>
                            <input type="number" id="productQty" placeholder="Ex: 50">
                        </div>
                        
                        <div class="form-group">
                            <label for="productCategory">Categoria:</label>
                            <select id="productCategory">
                                <option value="">Selecione uma categoria</option>
                                <option value="eletronicos">Eletr√¥nicos</option>
                                <option value="roupas">Roupas</option>
                                <option value="livros">Livros</option>
                                <option value="casa">Casa e Jardim</option>
                                <option value="esportes">Esportes</option>
                                <option value="beleza">Beleza e Cuidados</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="productImage">Imagem do Produto:</label>
                            <input type="file" id="productImage" accept="image/*" onchange="previewImage(event)">
                            <div class="image-preview" id="imagePreview">
                                <span style="color: #999;">Sem imagem</span>
                            </div>
                        </div>
                        
                        <div class="form-group full-width">
                            <label for="productDesc">Descri√ß√£o:</label>
                            <textarea id="productDesc" placeholder="Descreva as caracter√≠sticas do produto..."></textarea>
                        </div>
                    </div>
                    
                    <div class="product-buttons">
                        <button class="product-btn btn-electronics" onclick="loadElectronicsProduct()">
                            üì± Eletr√¥nico
                        </button>
                        <button class="product-btn btn-clothing" onclick="loadClothingProduct()">
                            üëï Roupa
                        </button>
                        <button class="product-btn btn-books" onclick="loadBookProduct()">
                            üìö Livro
                        </button>
                        <button class="product-btn btn-home" onclick="loadHomeProduct()">
                            üè† Casa
                        </button>
                        <button class="product-btn btn-sports" onclick="loadSportsProduct()">
                            ‚öΩ Esportes
                        </button>
                        <button class="product-btn btn-beauty" onclick="loadBeautyProduct()">
                            üíÑ Beleza
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="action-buttons">
                <button class="btn-info" onclick="voltarAoMenu()">üîô Voltar ao Menu</button>
                <button class="btn-primary" onclick="salvarProduto()">üíæ Salvar Produto</button>
                <button class="btn-secondary" onclick="novoProduto()">‚ûï Novo Produto</button>
                <button class="btn-danger" onclick="limparFormProduto()">üóëÔ∏è Limpar Formul√°rio</button>
            </div>
        </div>
    </div>

    <!-- Dialog do Assistente Virtual -->
    <div class="dialog-overlay" id="assistantDialog">
        <div class="dialog-content">
            <div class="dialog-header">
                <span style="font-size: 24px;">ü§ñ</span>
                <h3 id="assistantTitle">Assistente Virtual - ERP</h3>
                <button class="close-dialog" onclick="closeAssistantDialog()">√ó</button>
            </div>
            
            <div class="product-info" id="productInfo">
                <h4 id="selectedModuleTitle">M√≥dulo Selecionado:</h4>
                <p id="selectedProduct">Nenhum m√≥dulo selecionado</p>
            </div>
            
            <div class="question-area">
                <label for="userQuestion">Como posso ajudar voc√™ com este m√≥dulo?</label>
                <textarea 
                    id="userQuestion" 
                    placeholder="Digite sua d√∫vida ou solicita√ß√£o sobre este m√≥dulo. Ex: 'Como fazer isso?', 'Qual a melhor pr√°tica?', 'Me ajude com este processo'..."
                ></textarea>
            </div>
            
            <!-- √Årea de resposta do assistente -->
            <div class="response-area" id="responseArea">
                <div class="response-header">
                    <span style="font-size: 20px;">ü§ñ</span>
                    <h4 style="margin: 0; color: #28a745;">Resposta do Assistente</h4>
                </div>
                
                <div class="response-content" id="responseContent">
                    <!-- Resposta ser√° inserida aqui -->
                </div>
                
                <div class="response-meta" id="responseMeta">
                    <!-- Metadados da resposta -->
                </div>
                
                <div class="rating-section">
                    <div class="rating-title">üìù Avalie esta resposta:</div>
                    <div class="star-rating" id="starRating">
                        <span class="star" data-rating="1" title="1 estrela">‚≠ê</span>
                        <span class="star" data-rating="2" title="2 estrelas">‚≠ê</span>
                        <span class="star" data-rating="3" title="3 estrelas">‚≠ê</span>
                        <span class="star" data-rating="4" title="4 estrelas">‚≠ê</span>
                        <span class="star" data-rating="5" title="5 estrelas">‚≠ê</span>
                    </div>
                    
                    <div class="rating-feedback" id="ratingFeedback">
                        <textarea 
                            class="feedback-text" 
                            id="feedbackText"
                            placeholder="Deixe um coment√°rio sobre a resposta (opcional)..."
                        ></textarea>
                        <div class="rating-actions">
                            <button class="btn-rating btn-skip-rating" onclick="skipRating()">Pular Avalia√ß√£o</button>
                            <button class="btn-rating btn-submit-rating" onclick="submitRating()">Enviar Avalia√ß√£o</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="dialog-actions" id="dialogActions">
                <button class="btn-cancel" onclick="closeAssistantDialog()">Cancelar</button>
                <button class="btn-send" onclick="sendToAssistant()">Enviar Pergunta</button>
            </div>
        </div>
    </div>

    <script>
        // Fun√ß√£o para preview da imagem
        function previewImage(event) {
            const file = event.target.files[0];
            const preview = document.getElementById('imagePreview');
            
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    preview.innerHTML = `<img src="${e.target.result}" alt="Preview">`;
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '<span style="color: #999;">Sem imagem</span>';
            }
        }

        // Fun√ß√£o para carregar produto eletr√¥nico
        function loadElectronicsProduct() {
            document.getElementById('productCode').value = 'ELE001';
            document.getElementById('productName').value = 'Smartphone Samsung Galaxy A32';
            document.getElementById('productEan').value = '7891234567890';
            document.getElementById('productRef').value = 'SM-A325F';
            document.getElementById('productQty').value = '25';
            document.getElementById('productCategory').value = 'eletronicos';
            document.getElementById('productDesc').value = 'Smartphone Android com tela de 6.4", 128GB de armazenamento, c√¢mera qu√°drupla de 64MP, bateria de 5000mAh e processador MediaTek Helio G80.';
            
            // Simular imagem
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<div style="background: linear-gradient(45deg, #007bff, #0056b3); color: white; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 24px;">üì±</div>';
        }

        // Fun√ß√£o para carregar produto de roupa
        function loadClothingProduct() {
            document.getElementById('productCode').value = 'ROU001';
            document.getElementById('productName').value = 'Camiseta Polo Masculina';
            document.getElementById('productEan').value = '7891234567891';
            document.getElementById('productRef').value = 'POL-M-AZ';
            document.getElementById('productQty').value = '40';
            document.getElementById('productCategory').value = 'roupas';
            document.getElementById('productDesc').value = 'Camiseta polo masculina 100% algod√£o, cor azul marinho, tamanho M. Gola com bot√µes, manga curta, corte regular. Ideal para uso casual e social.';
            
            // Simular imagem
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<div style="background: linear-gradient(45deg, #ffc107, #e0a800); color: #333; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 24px;">üëï</div>';
        }

        // Fun√ß√£o para carregar produto livro
        function loadBookProduct() {
            document.getElementById('productCode').value = 'LIV001';
            document.getElementById('productName').value = 'Clean Code - C√≥digo Limpo';
            document.getElementById('productEan').value = '7891234567892';
            document.getElementById('productRef').value = 'CC-MARTIN';
            document.getElementById('productQty').value = '15';
            document.getElementById('productCategory').value = 'livros';
            document.getElementById('productDesc').value = 'Livro sobre boas pr√°ticas de programa√ß√£o por Robert C. Martin. Ensina como escrever c√≥digo limpo, leg√≠vel e manuten√≠vel. Essencial para desenvolvedores de software.';
            
            // Simular imagem
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<div style="background: linear-gradient(45deg, #6f42c1, #5a359b); color: white; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 24px;">üìö</div>';
        }

        // Fun√ß√£o para carregar produto casa e jardim
        function loadHomeProduct() {
            document.getElementById('productCode').value = 'CAS001';
            document.getElementById('productName').value = 'Aspirador de P√≥ Rob√¥';
            document.getElementById('productEan').value = '7891234567893';
            document.getElementById('productRef').value = 'ROBOT-V10';
            document.getElementById('productQty').value = '8';
            document.getElementById('productCategory').value = 'casa';
            document.getElementById('productDesc').value = 'Aspirador de p√≥ rob√¥ inteligente com mapeamento laser, suc√ß√£o de 2700Pa, bateria de 5200mAh para at√© 3 horas de limpeza, compat√≠vel com app m√≥vel e assistentes virtuais.';
            
            // Simular imagem
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<div style="background: linear-gradient(45deg, #fd7e14, #e8650e); color: white; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 24px;">üè†</div>';
        }

        // Fun√ß√£o para carregar produto esportivo
        function loadSportsProduct() {
            document.getElementById('productCode').value = 'ESP001';
            document.getElementById('productName').value = 'T√™nis de Corrida Nike Air Max';
            document.getElementById('productEan').value = '7891234567894';
            document.getElementById('productRef').value = 'AIR-MAX-270';
            document.getElementById('productQty').value = '30';
            document.getElementById('productCategory').value = 'esportes';
            document.getElementById('productDesc').value = 'T√™nis de corrida masculino com tecnologia Air Max, amortecimento responsivo, cabedal em mesh respir√°vel, sola de borracha antiderrapante. Ideal para caminhadas e corridas.';
            
            // Simular imagem
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<div style="background: linear-gradient(45deg, #20c997, #1ba085); color: white; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 24px;">‚öΩ</div>';
        }

        // Fun√ß√£o para carregar produto de beleza
        function loadBeautyProduct() {
            document.getElementById('productCode').value = 'BEL001';
            document.getElementById('productName').value = 'Base L√≠quida Matte HD';
            document.getElementById('productEan').value = '7891234567895';
            document.getElementById('productRef').value = 'BASE-HD-30ML';
            document.getElementById('productQty').value = '60';
            document.getElementById('productCategory').value = 'beleza';
            document.getElementById('productDesc').value = 'Base l√≠quida de alta cobertura com acabamento matte, longa dura√ß√£o de 16 horas, FPS 20, f√≥rmula oil-free e n√£o comedog√™nica. Dispon√≠vel em 20 tons diferentes.';
            
            // Simular imagem
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '<div style="background: linear-gradient(45deg, #e83e8c, #d91a72); color: white; width: 90px; height: 90px; display: flex; align-items: center; justify-content: center; border-radius: 4px; font-size: 24px;">üíÑ</div>';
        }

        // Fun√ß√µes do Assistente Virtual
        function openAssistantDialog() {
            // Coletar informa√ß√µes do produto atual
            const productData = getProductData();
            
            // Atualizar a exibi√ß√£o no dialog
            updateProductInfo(productData);
            
            // Mostrar o dialog
            document.getElementById('assistantDialog').style.display = 'flex';
            
            // Focar no textarea
            setTimeout(() => {
                document.getElementById('userQuestion').focus();
            }, 100);
        }

        function closeAssistantDialog() {
            document.getElementById('assistantDialog').style.display = 'none';
            document.getElementById('userQuestion').value = '';
            
            // Reset do estado da resposta
            document.getElementById('responseArea').classList.remove('show');
            document.getElementById('ratingFeedback').classList.remove('show');
            resetStarRating();
            
            // Reset dos bot√µes de a√ß√£o
            const dialogActions = document.getElementById('dialogActions');
            dialogActions.innerHTML = `
                <button class="btn-cancel" onclick="closeAssistantDialog()">Cancelar</button>
                <button class="btn-send" onclick="sendToAssistant()">Enviar Pergunta</button>
            `;
        }

        function getProductData() {
            // Obter informa√ß√µes do usu√°rio conectado
            const userSelect = document.getElementById('userSelect');
            const currentUser = userSelect.value ? JSON.parse(userSelect.value) : null;
            
            // Detectar qual card est√° vis√≠vel (m√≥dulo ativo)
            const activeCard = getActiveCard();
            let moduleData = {};
            
            if (activeCard) {
                switch(activeCard.id) {
                    case 'clientesCard':
                        moduleData = getClienteData();
                        break;
                    case 'vendasCard':
                        moduleData = getVendaData();
                        break;
                    case 'transportadorasCard':
                        moduleData = getTransportadoraData();
                        break;
                    case 'notasFiscaisCard':
                        moduleData = getNotaFiscalData();
                        break;
                    case 'usuariosCard':
                        moduleData = getUsuarioData();
                        break;
                    case 'empresaCard':
                        moduleData = getEmpresaData();
                        break;
                    default:
                        // Card de produtos (padr√£o)
                        moduleData = getProductDataOriginal();
                        break;
                }
            } else {
                // Se nenhum card espec√≠fico est√° ativo, usar dados de produtos
                moduleData = getProductDataOriginal();
            }
            
            return {
                user: currentUser ? {
                    id: currentUser.id,
                    name: currentUser.name,
                    email: currentUser.email,
                    active: currentUser.active
                } : null,
                module: moduleData,
                timestamp: new Date().toISOString()
            };
        }
        
        // Fun√ß√£o para detectar o card ativo
        function getActiveCard() {
            const cards = document.querySelectorAll('.card[id$="Card"]');
            for (let card of cards) {
                if (card.style.display !== 'none' && card.classList.contains('show')) {
                    return card;
                }
            }
            // Se nenhum card espec√≠fico est√° ativo, verificar o card de produtos
            const productCard = document.querySelector('.card:has(.virtual-assistant):not([id$="Card"])');
            if (productCard && productCard.style.display !== 'none') {
                return { id: 'productCard' };
            }
            return null;
        }
        
        // Fun√ß√µes para capturar dados de cada m√≥dulo
        function getClienteData() {
            return {
                type: 'Clientes',
                icon: 'üë•',
                title: 'Gest√£o de Clientes',
                data: {
                    nome: document.getElementById('clienteNome')?.value || 'N√£o informado',
                    tipo: document.getElementById('clienteTipo')?.value || 'N√£o selecionado',
                    documento: document.getElementById('clienteDocumento')?.value || 'N√£o informado',
                    email: document.getElementById('clienteEmail')?.value || 'N√£o informado',
                    telefone: document.getElementById('clienteTelefone')?.value || 'N√£o informado',
                    cep: document.getElementById('clienteCep')?.value || 'N√£o informado'
                }
            };
        }
        
        function getVendaData() {
            return {
                type: 'Vendas',
                icon: 'üí∞',
                title: 'Gest√£o de Vendas',
                data: {
                    numero: document.getElementById('vendaNumero')?.value || 'N√£o informado',
                    cliente: document.getElementById('vendaCliente')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    data: document.getElementById('vendaData')?.value || 'N√£o informado',
                    vendedor: document.getElementById('vendaVendedor')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    formaPagamento: document.getElementById('vendaFormaPagamento')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    total: document.getElementById('vendaTotal')?.value || 'N√£o informado'
                }
            };
        }
        
        function getTransportadoraData() {
            return {
                type: 'Transportadoras',
                icon: 'üöö',
                title: 'Gest√£o de Transportadoras',
                data: {
                    nome: document.getElementById('transpNome')?.value || 'N√£o informado',
                    cnpj: document.getElementById('transpCnpj')?.value || 'N√£o informado',
                    contato: document.getElementById('transpContato')?.value || 'N√£o informado',
                    telefone: document.getElementById('transpTelefone')?.value || 'N√£o informado',
                    email: document.getElementById('transpEmail')?.value || 'N√£o informado',
                    regiao: document.getElementById('transpRegiao')?.selectedOptions[0]?.text || 'N√£o selecionado'
                }
            };
        }
        
        function getNotaFiscalData() {
            return {
                type: 'Notas Fiscais',
                icon: 'üìÑ',
                title: 'Gest√£o de Notas Fiscais',
                data: {
                    numero: document.getElementById('nfNumero')?.value || 'N√£o informado',
                    serie: document.getElementById('nfSerie')?.value || 'N√£o informado',
                    tipo: document.getElementById('nfTipo')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    operacao: document.getElementById('nfOperacao')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    cliente: document.getElementById('nfCliente')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    valor: document.getElementById('nfValor')?.value || 'N√£o informado'
                }
            };
        }
        
        function getUsuarioData() {
            return {
                type: 'Usu√°rios',
                icon: 'üë§',
                title: 'Gest√£o de Usu√°rios',
                data: {
                    nome: document.getElementById('usuarioNome')?.value || 'N√£o informado',
                    login: document.getElementById('usuarioLogin')?.value || 'N√£o informado',
                    email: document.getElementById('usuarioEmail')?.value || 'N√£o informado',
                    perfil: document.getElementById('usuarioPerfil')?.selectedOptions[0]?.text || 'N√£o selecionado',
                    status: document.getElementById('usuarioStatus')?.selectedOptions[0]?.text || 'N√£o selecionado'
                }
            };
        }
        
        function getEmpresaData() {
            return {
                type: 'Empresa',
                icon: 'üè¢',
                title: 'Dados da Empresa',
                data: {
                    razaoSocial: document.getElementById('empresaNome')?.value || 'N√£o informado',
                    nomeFantasia: document.getElementById('empresaFantasia')?.value || 'N√£o informado',
                    cnpj: document.getElementById('empresaCnpj')?.value || 'N√£o informado',
                    inscricaoEstadual: document.getElementById('empresaIE')?.value || 'N√£o informado',
                    telefone: document.getElementById('empresaTelefone')?.value || 'N√£o informado',
                    email: document.getElementById('empresaEmail')?.value || 'N√£o informado'
                }
            };
        }
        
        function getProductDataOriginal() {
            const productCode = document.getElementById('productCode')?.value;
            const productName = document.getElementById('productName')?.value;
            const productEan = document.getElementById('productEan')?.value;
            const productRef = document.getElementById('productRef')?.value;
            const productQty = document.getElementById('productQty')?.value;
            const productCategory = document.getElementById('productCategory')?.value;
            const productDesc = document.getElementById('productDesc')?.value;
            
            // Determinar qual produto est√° selecionado baseado nos dados
            let selectedProductType = 'Personalizado';
            if (productCode === 'ELE001') selectedProductType = 'Eletr√¥nico - Smartphone';
            else if (productCode === 'ROU001') selectedProductType = 'Roupa - Camiseta Polo';
            else if (productCode === 'LIV001') selectedProductType = 'Livro - Clean Code';
            else if (productCode === 'CAS001') selectedProductType = 'Casa - Aspirador Rob√¥';
            else if (productCode === 'ESP001') selectedProductType = 'Esportes - T√™nis Nike';
            else if (productCode === 'BEL001') selectedProductType = 'Beleza - Base Matte';
            
            return {
                type: 'Produtos',
                icon: 'üì¶',
                title: 'Cadastro de Produtos',
                data: {
                    selectedType: selectedProductType,
                    code: productCode || 'N√£o informado',
                    name: productName || 'N√£o informado',
                    ean: productEan || 'N√£o informado',
                    reference: productRef || 'N√£o informado',
                    quantity: productQty || 'N√£o informado',
                    category: productCategory || 'N√£o selecionada',
                    description: productDesc || 'N√£o informada'
                }
            };
        }

        function updateProductInfo(data) {
            const productInfoElement = document.getElementById('selectedProduct');
            const assistantTitle = document.getElementById('assistantTitle');
            const moduleTitle = document.getElementById('selectedModuleTitle');
            
            // Atualizar t√≠tulo do assistente
            if (data.module && data.module.type) {
                assistantTitle.textContent = `Assistente Virtual - ${data.module.type}`;
                moduleTitle.textContent = `${data.module.icon} ${data.module.title}:`;
            } else {
                assistantTitle.textContent = 'Assistente Virtual - ERP';
                moduleTitle.textContent = 'M√≥dulo Selecionado:';
            }
            
            // Informa√ß√µes do usu√°rio
            let userInfo = '';
            if (data.user) {
                userInfo = `
                    <div style="background-color: #e8f5e8; padding: 10px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid #28a745;">
                        <strong>üë§ Usu√°rio:</strong> ${data.user.name}<br>
                        <strong>üìß Email:</strong> ${data.user.email}
                    </div>
                `;
            } else {
                userInfo = `
                    <div style="background-color: #fff3cd; padding: 10px; border-radius: 6px; margin-bottom: 15px; border-left: 3px solid #ffc107;">
                        <strong>‚ö†Ô∏è Nenhum usu√°rio selecionado</strong><br>
                        <small>Selecione um usu√°rio no card acima para personalizar a assist√™ncia.</small>
                    </div>
                `;
            }
            
            // Informa√ß√µes do m√≥dulo espec√≠fico
            let moduleInfo = '';
            if (data.module && data.module.type) {
                moduleInfo = generateModuleInfo(data.module);
            } else {
                moduleInfo = `
                    <div style="background-color: #f8d7da; padding: 10px; border-radius: 6px; border-left: 3px solid #dc3545;">
                        <span style="color: #721c24;">‚ö†Ô∏è Nenhum m√≥dulo ativo</span><br>
                        <small>Selecione um m√≥dulo no menu principal para usar o assistente.</small>
                    </div>
                `;
            }
            
            productInfoElement.innerHTML = userInfo + moduleInfo;
        }
        
        function generateModuleInfo(module) {
            const hasData = Object.values(module.data).some(value => 
                value !== 'N√£o informado' && value !== 'N√£o selecionado' && value !== 'N√£o selecionada'
            );
            
            if (!hasData) {
                return `
                    <div style="background-color: #f8d7da; padding: 10px; border-radius: 6px; border-left: 3px solid #dc3545;">
                        <span style="color: #721c24;">‚ö†Ô∏è Dados do m√≥dulo ${module.type} n√£o preenchidos</span><br>
                        <small>Preencha os campos do formul√°rio para obter assist√™ncia personalizada.</small>
                    </div>
                `;
            }
            
            let infoHTML = `
                <div style="background-color: #d1ecf1; padding: 10px; border-radius: 6px; border-left: 3px solid #17a2b8;">
                    <strong>${module.icon} ${module.type}</strong><br>
            `;
            
            // Gerar informa√ß√µes espec√≠ficas baseadas no tipo de m√≥dulo
            switch(module.type) {
                case 'Clientes':
                    infoHTML += `
                        <strong>Nome:</strong> ${module.data.nome}<br>
                        <strong>Tipo:</strong> ${module.data.tipo}<br>
                        <strong>Documento:</strong> ${module.data.documento}<br>
                        <strong>Email:</strong> ${module.data.email}
                    `;
                    break;
                    
                case 'Vendas':
                    infoHTML += `
                        <strong>N√∫mero:</strong> ${module.data.numero}<br>
                        <strong>Cliente:</strong> ${module.data.cliente}<br>
                        <strong>Vendedor:</strong> ${module.data.vendedor}<br>
                        <strong>Valor Total:</strong> R$ ${module.data.total}
                    `;
                    break;
                    
                case 'Transportadoras':
                    infoHTML += `
                        <strong>Nome:</strong> ${module.data.nome}<br>
                        <strong>CNPJ:</strong> ${module.data.cnpj}<br>
                        <strong>Contato:</strong> ${module.data.contato}<br>
                        <strong>Regi√£o:</strong> ${module.data.regiao}
                    `;
                    break;
                    
                case 'Notas Fiscais':
                    infoHTML += `
                        <strong>N√∫mero:</strong> ${module.data.numero}<br>
                        <strong>Tipo:</strong> ${module.data.tipo}<br>
                        <strong>Opera√ß√£o:</strong> ${module.data.operacao}<br>
                        <strong>Cliente:</strong> ${module.data.cliente}
                    `;
                    break;
                    
                case 'Usu√°rios':
                    infoHTML += `
                        <strong>Nome:</strong> ${module.data.nome}<br>
                        <strong>Login:</strong> ${module.data.login}<br>
                        <strong>Perfil:</strong> ${module.data.perfil}<br>
                        <strong>Status:</strong> ${module.data.status}
                    `;
                    break;
                    
                case 'Empresa':
                    infoHTML += `
                        <strong>Raz√£o Social:</strong> ${module.data.razaoSocial}<br>
                        <strong>Nome Fantasia:</strong> ${module.data.nomeFantasia}<br>
                        <strong>CNPJ:</strong> ${module.data.cnpj}<br>
                        <strong>Telefone:</strong> ${module.data.telefone}
                    `;
                    break;
                    
                case 'Produtos':
                    infoHTML += `
                        <strong>Tipo:</strong> ${module.data.selectedType}<br>
                        <strong>C√≥digo:</strong> ${module.data.code}<br>
                        <strong>Nome:</strong> ${module.data.name}<br>
                        <strong>Categoria:</strong> ${module.data.category}
                    `;
                    break;
            }
            
            infoHTML += `</div>`;
            return infoHTML;
        }

        async function sendToAssistant() {
            const data = getProductData();
            const userQuestion = document.getElementById('userQuestion').value.trim();
            
            if (!userQuestion) {
                alert('Por favor, digite sua pergunta ou solicita√ß√£o.');
                return;
            }
            
            // Criar o JSON com todas as informa√ß√µes
            const assistantRequest = {
                user: data.user,
                module: data.module, // Usando 'module' em vez de 'product'
                userQuestion: userQuestion,
                requestId: generateRequestId(),
                timestamp: new Date().toISOString()
            };
            
            console.log('Enviando dados para o Assistente Virtual:', JSON.stringify(assistantRequest, null, 2));
            
            // Mostrar indicador de carregamento
            const sendButton = document.querySelector('.btn-send');
            const originalText = sendButton.textContent;
            sendButton.innerHTML = '<span class="loading-spinner"></span>Enviando...';
            sendButton.disabled = true;
            
            // Desabilitar textarea
            document.getElementById('userQuestion').disabled = true;
            
            try {
                // Fazer chamada para a API
                const response = await fetch('/api/assistant', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(assistantRequest)
                });
                
                const result = await response.json();
                console.log('Resposta do Assistente:', result);
                
                // Mostrar resposta no dialog
                displayAssistantResponse(result, assistantRequest);
                
            } catch (error) {
                console.error('Erro ao enviar para assistente:', error);
                displayErrorResponse('Erro de conex√£o ao enviar para o assistente virtual. Tente novamente.');
            } finally {
                // Restaurar bot√£o
                sendButton.textContent = originalText;
                sendButton.disabled = false;
                document.getElementById('userQuestion').disabled = false;
            }
        }
        
        function displayAssistantResponse(result, originalRequest) {
            const responseArea = document.getElementById('responseArea');
            const responseContent = document.getElementById('responseContent');
            const responseMeta = document.getElementById('responseMeta');
            const dialogActions = document.getElementById('dialogActions');
            
            // Determinar a resposta a ser exibida
            let responseText = '';
            let isError = false;
            
            if (result.success) {
                responseText = result.response || 'Resposta n√£o dispon√≠vel';
            } else {
                isError = true;
                // Para erros, n√£o usar fallback_response, apenas mostrar o erro
                responseText = result.error || 'Erro desconhecido';
            }
            
            // Exibir resposta
            if (isError) {
                responseContent.innerHTML = `
                    <div style="color: #dc3545; font-size: 14px; text-align: center; padding: 20px;">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚ö†Ô∏è</div>
                        <div style="font-weight: bold; margin-bottom: 10px;">Ops! Algo deu errado</div>
                        <div style="margin-bottom: 15px;">${responseText}</div>
                        <button onclick="startNewQuestion()" style="background: #007bff; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer;">
                            üîÑ Tentar Novamente
                        </button>
                    </div>
                `;
            } else {
                responseContent.innerHTML = `
                    <div style="white-space: pre-wrap; font-size: 14px;">${responseText}</div>
                `;
            }
            
            // Exibir metadados
            let metaHTML = '';
            if (result.success) {
                if (result.categoria) {
                    metaHTML += `<div class="meta-item">üìÇ <strong>Categoria:</strong><br>${result.categoria}</div>`;
                }
                if (result.tokens_used) {
                    metaHTML += `<div class="meta-item">üî¢ <strong>Tokens:</strong><br>${result.tokens_used}</div>`;
                }
                if (result.response_time) {
                    metaHTML += `<div class="meta-item">‚è±Ô∏è <strong>Tempo:</strong><br>${result.response_time.toFixed(2)}s</div>`;
                }
                metaHTML += `<div class="meta-item">üÜî <strong>ID:</strong><br>${result.request_id || 'N/A'}</div>`;
            } else {
                metaHTML += `<div class="meta-item">‚ùå <strong>Status:</strong><br>Erro</div>`;
                if (result.timeout) {
                    metaHTML += `<div class="meta-item">‚è∞ <strong>Tipo:</strong><br>Timeout</div>`;
                } else if (result.connection_error) {
                    metaHTML += `<div class="meta-item">üîå <strong>Tipo:</strong><br>Conex√£o</div>`;
                } else if (result.unexpected_error) {
                    metaHTML += `<div class="meta-item">üêõ <strong>Tipo:</strong><br>Inesperado</div>`;
                }
                metaHTML += `<div class="meta-item">üïí <strong>Hora:</strong><br>${new Date().toLocaleTimeString()}</div>`;
            }
            
            responseMeta.innerHTML = metaHTML;
            
            // Mostrar √°rea de resposta
            responseArea.classList.add('show');
            
            // Atualizar bot√µes de a√ß√£o baseado no sucesso
            if (result.success) {
                // Salvar dados para avalia√ß√£o apenas quando bem-sucedido
                window.currentAssistantResponse = {
                    result: result,
                    request: originalRequest,
                    timestamp: new Date().toISOString()
                };
                
                dialogActions.innerHTML = `
                    <button class="btn-cancel" onclick="startNewQuestion()">Nova Pergunta</button>
                    <button class="btn-send" onclick="closeAssistantDialog()" style="background: #28a745;">Finalizar</button>
                `;
                
                // Configurar sistema de estrelas apenas para sucesso
                setupStarRating();
            } else {
                // Para erros, apenas bot√£o de nova pergunta e finalizar
                window.currentAssistantResponse = null;
                
                dialogActions.innerHTML = `
                    <button class="btn-cancel" onclick="startNewQuestion()">üîÑ Tentar Novamente</button>
                    <button class="btn-send" onclick="closeAssistantDialog()" style="background: #6c757d;">Fechar</button>
                `;
                
                // N√£o configurar sistema de estrelas para erros
            }
        }
        
        function displayErrorResponse(errorMessage) {
            const responseArea = document.getElementById('responseArea');
            const responseContent = document.getElementById('responseContent');
            const responseMeta = document.getElementById('responseMeta');
            
            responseContent.innerHTML = `
                <div style="color: #dc3545; font-size: 14px;">
                    <strong>‚ùå Erro:</strong><br>
                    ${errorMessage}
                </div>
            `;
            
            responseMeta.innerHTML = `
                <div class="meta-item">‚ùå <strong>Status:</strong><br>Erro de Conex√£o</div>
                <div class="meta-item">üïí <strong>Hora:</strong><br>${new Date().toLocaleTimeString()}</div>
            `;
            
            responseArea.classList.add('show');
        }
        
        function startNewQuestion() {
            // Reset da interface para nova pergunta
            document.getElementById('responseArea').classList.remove('show');
            document.getElementById('ratingFeedback').classList.remove('show');
            document.getElementById('userQuestion').value = '';
            document.getElementById('userQuestion').disabled = false;
            resetStarRating();
            
            // Restaurar bot√µes originais
            const dialogActions = document.getElementById('dialogActions');
            dialogActions.innerHTML = `
                <button class="btn-cancel" onclick="closeAssistantDialog()">Cancelar</button>
                <button class="btn-send" onclick="sendToAssistant()">Enviar Pergunta</button>
            `;
            
            // Focar no textarea
            document.getElementById('userQuestion').focus();
        }

        function generateRequestId() {
            return 'req_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // Sistema de avalia√ß√£o com estrelas
        function setupStarRating() {
            const stars = document.querySelectorAll('.star');
            
            // Resetar estrelas
            resetStarRating();
            
            stars.forEach((star, index) => {
                // Remover event listeners existentes
                star.replaceWith(star.cloneNode(true));
            });
            
            // Re-selecionar ap√≥s clonar
            const newStars = document.querySelectorAll('.star');
            
            newStars.forEach((star, index) => {
                const starRating = index + 1;
                
                star.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    console.log(`Estrela ${starRating} clicada`);
                    setStarRating(starRating);
                    showRatingFeedback();
                });
                
                star.addEventListener('mouseenter', function() {
                    highlightStarsUp(starRating);
                });
                
                star.addEventListener('mouseleave', function() {
                    const currentRating = getCurrentRating();
                    if (currentRating > 0) {
                        highlightStarsUp(currentRating);
                    } else {
                        clearHighlight();
                    }
                });
            });
        }
        
        function setStarRating(rating) {
            console.log(`Definindo rating: ${rating}`);
            window.currentRating = rating;
            
            const stars = document.querySelectorAll('.star');
            stars.forEach((star, index) => {
                star.classList.remove('selected', 'temp-highlight');
                if (index < rating) {
                    star.classList.add('selected');
                    star.style.color = '#ffc107';
                } else {
                    star.style.color = '#ddd';
                }
            });
        }
        
        function highlightStarsUp(rating) {
            const stars = document.querySelectorAll('.star');
            stars.forEach((star, index) => {
                star.classList.remove('temp-highlight');
                if (index < rating) {
                    if (!star.classList.contains('selected')) {
                        star.classList.add('temp-highlight');
                    }
                    star.style.color = '#ffc107';
                } else {
                    star.style.color = '#ddd';
                }
            });
        }
        
        function clearHighlight() {
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => {
                star.classList.remove('temp-highlight');
                if (!star.classList.contains('selected')) {
                    star.style.color = '#ddd';
                }
            });
        }
        
        function getCurrentRating() {
            return window.currentRating || 0;
        }
        
        function resetStarRating() {
            console.log('Resetando sistema de estrelas');
            window.currentRating = 0;
            
            const stars = document.querySelectorAll('.star');
            stars.forEach(star => {
                star.classList.remove('selected', 'temp-highlight');
                star.style.color = '#ddd';
            });
            
            const feedbackText = document.getElementById('feedbackText');
            if (feedbackText) {
                feedbackText.value = '';
            }
            
            const ratingFeedback = document.getElementById('ratingFeedback');
            if (ratingFeedback) {
                ratingFeedback.classList.remove('show');
            }
        }
        
        function showRatingFeedback() {
            console.log('Mostrando √°rea de feedback');
            const ratingFeedback = document.getElementById('ratingFeedback');
            if (ratingFeedback) {
                ratingFeedback.classList.add('show');
            }
        }
        
        function skipRating() {
            console.log('Avalia√ß√£o pulada pelo usu√°rio');
            const ratingFeedback = document.getElementById('ratingFeedback');
            if (ratingFeedback) {
                ratingFeedback.classList.remove('show');
            }
            resetStarRating();
        }
        
        async function submitRating() {
            const rating = getCurrentRating();
            const feedbackTextEl = document.getElementById('feedbackText');
            const feedback = feedbackTextEl ? feedbackTextEl.value.trim() : '';
            
            console.log(`Tentando enviar avalia√ß√£o: ${rating} estrelas`);
            
            if (rating === 0) {
                alert('Por favor, selecione uma avalia√ß√£o de 1 a 5 estrelas.');
                return;
            }
            
            // Verificar se temos uma resposta atual para avaliar
            if (!window.currentAssistantResponse || !window.currentAssistantResponse.result) {
                console.error('Dados da resposta n√£o encontrados:', window.currentAssistantResponse);
                alert('Erro: N√£o foi poss√≠vel identificar a solicita√ß√£o para avalia√ß√£o.');
                return;
            }
            
            // Usar o local_id ou request_id como fallback
            const feedbackId = window.currentAssistantResponse.result.local_id || 
                              window.currentAssistantResponse.result.request_id ||
                              'temp_' + Date.now();
            
            console.log('ID para feedback:', feedbackId);
            
            const ratingData = {
                rating: rating,
                feedback: feedback,
                response_data: window.currentAssistantResponse,
                timestamp: new Date().toISOString()
            };
            
            console.log('Dados da avalia√ß√£o:', ratingData);
            
            // Desabilitar bot√£o durante envio
            const submitBtn = document.querySelector('.btn-submit-rating');
            if (!submitBtn) {
                console.error('Bot√£o de envio n√£o encontrado');
                return;
            }
            
            const originalText = submitBtn.textContent;
            submitBtn.innerHTML = '<span class="loading-spinner"></span>Enviando...';
            submitBtn.disabled = true;
            
            try {
                console.log(`Enviando para: /api/feedback/${feedbackId}`);
                
                const response = await fetch(`/api/feedback/${feedbackId}`, {
                    method: 'PUT',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(ratingData)
                });
                
                console.log('Status da resposta:', response.status);
                
                if (response.ok) {
                    const result = await response.json();
                    console.log('Feedback enviado com sucesso:', result);
                    
                    // Mostrar sucesso
                    submitBtn.textContent = '‚úÖ Enviado!';
                    submitBtn.style.background = '#28a745';
                    
                    setTimeout(() => {
                        const ratingFeedback = document.getElementById('ratingFeedback');
                        if (ratingFeedback) {
                            ratingFeedback.classList.remove('show');
                        }
                        resetStarRating();
                        
                        // Restaurar bot√£o
                        submitBtn.textContent = originalText;
                        submitBtn.style.background = '';
                        submitBtn.disabled = false;
                    }, 2000);
                } else {
                    const errorText = await response.text();
                    console.error('Erro HTTP:', response.status, errorText);
                    alert(`Erro ao enviar avalia√ß√£o: ${response.status}`);
                    
                    submitBtn.textContent = originalText;
                    submitBtn.disabled = false;
                }
                
            } catch (error) {
                console.error('Erro na requisi√ß√£o:', error);
                alert('Erro de conex√£o ao enviar avalia√ß√£o.');
                
                submitBtn.textContent = originalText;
                submitBtn.disabled = false;
            }
        }

        // Fechar dialog com ESC
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeAssistantDialog();
            }
        });

        // Test health check on page load
        window.onload = async function() {
            try {
                const response = await fetch('/api/health');
                const data = await response.json();
                console.log('Health check:', data);
                
                // Carregar usu√°rios dispon√≠veis
                await loadUsers();
                
                // Inicializar listas dos cards
                if (typeof loadClientesList === 'function') {
                    loadClientesList();
                }
                if (typeof loadProductsList === 'function') {
                    loadProductsList();
                }
                if (typeof loadTransportadorasList === 'function') {
                    loadTransportadorasList();
                }
                if (typeof loadVendasList === 'function') {
                    loadVendasList();
                }
                if (typeof loadNotasFiscaisList === 'function') {
                    loadNotasFiscaisList();
                }
                if (typeof loadUsuariosList === 'function') {
                    loadUsuariosList();
                }
            } catch (error) {
                console.error('Health check failed:', error);
            }
        };

        // Fun√ß√£o para carregar usu√°rios da API
        async function loadUsers() {
            try {
                const response = await fetch('/api/users/');
                const users = await response.json();
                
                const userSelect = document.getElementById('userSelect');
                userSelect.innerHTML = '<option value="">-- Selecione --</option>';
                
                users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = JSON.stringify(user);
                    option.textContent = `${user.name} (${user.email})`;
                    userSelect.appendChild(option);
                });
                
                console.log('Usu√°rios carregados:', users);
            } catch (error) {
                console.error('Erro ao carregar usu√°rios:', error);
            }
        }

        // Fun√ß√£o para selecionar usu√°rio
        function selectUser() {
            const userSelect = document.getElementById('userSelect');
            const selectedValue = userSelect.value;
            
            if (selectedValue) {
                const user = JSON.parse(selectedValue);
                document.getElementById('currentUserName').innerHTML = 
                    `<span class="user-status"></span>${user.name}`;
                document.getElementById('currentUserEmail').textContent = user.email;
                
                console.log('Usu√°rio selecionado:', user);
            } else {
                document.getElementById('currentUserName').textContent = 'Selecione um usu√°rio';
                document.getElementById('currentUserEmail').textContent = '';
            }
        }
        
        // Fun√ß√£o de navega√ß√£o do menu principal
        function navigateTo(section) {
            console.log(`Navegando para: ${section}`);
            
            // Feedback visual do clique
            const button = event.target;
            const originalBackground = button.style.background;
            button.style.background = 'rgba(255, 255, 255, 0.4)';
            
            setTimeout(() => {
                button.style.background = originalBackground;
            }, 200);
            
            // Implementar navega√ß√£o baseada na se√ß√£o
            switch(section) {
                case 'produtos':
                    // Ocultar todos os cards primeiro
                    hideAllCards();
                    // Mostrar cards comuns
                    showCommonCards();
                    // Mostrar o card de produtos
                    showCard(document.getElementById('produtosCard'));
                    document.getElementById('produtosCard').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    // Inicializar na aba de listagem
                    switchProductTab('listagem');
                    break;
                    
                case 'clientes':
                    hideAllCards();
                    showCommonCards(); // Manter menu principal vis√≠vel
                    showCardById('clientesCard');
                    // Inicializar a aba de listagem e carregar clientes
                    switchClienteTab('listagem');
                    break;
                    
                case 'vendas':
                    hideAllCards();
                    showCommonCards(); // Manter menu principal vis√≠vel
                    showCardById('vendasCard');
                    // Inicializar na aba de listagem
                    switchVendaTab('listagem');
                    break;
                    
                case 'transportadoras':
                    hideAllCards();
                    showCommonCards(); // Manter menu principal vis√≠vel
                    showCardById('transportadorasCard');
                    // Inicializar na aba de listagem
                    switchTransportadoraTab('listagem');
                    break;
                    
                case 'notas-fiscais':
                    hideAllCards();
                    showCommonCards(); // Manter menu principal vis√≠vel
                    showCardById('notasFiscaisCard');
                    // Inicializar na aba de listagem
                    switchNotaFiscalTab('listagem');
                    break;
                    
                case 'usuarios':
                    hideAllCards();
                    showCommonCards(); // Manter menu principal vis√≠vel
                    showCardById('usuariosCard');
                    // Inicializar na aba de listagem
                    switchUsuarioTab('listagem');
                    break;
                    
                case 'empresa':
                    hideAllCards();
                    showCommonCards(); // Manter menu principal vis√≠vel
                    showCardById('empresaCard');
                    break;
                    
                default:
                    console.log('Se√ß√£o n√£o implementada:', section);
                    showTemporaryMessage(`üìã ${section.charAt(0).toUpperCase() + section.slice(1).replace('-', ' ')}`, 'Funcionalidade em desenvolvimento. Em breve estar√° dispon√≠vel!');
            }
        }
        
        // Fun√ß√£o para ocultar todos os cards
        function hideAllCards() {
            // Ocultar cards dos m√≥dulos
            const moduleCards = document.querySelectorAll('.card[id$="Card"]');
            moduleCards.forEach(card => {
                card.style.display = 'none';
                card.classList.remove('show');
            });
            
            // Ocultar card de produtos se n√£o for o foco
            const productCard = document.querySelector('.card:has(.virtual-assistant):not([id$="Card"])');
            if (productCard) {
                productCard.style.display = 'none';
                productCard.classList.remove('show');
            }
            
            // N√£o ocultar mais os cards comuns por padr√£o
            // Eles s√≥ ser√£o ocultados quando voltarAoMenu() for chamado
        }
        
        // Fun√ß√£o para mostrar cards comuns (user e navigation)
        function showCommonCards() {
            const userCard = document.querySelector('.user-card');
            const navMenu = document.querySelector('.navigation-menu');
            if (userCard) userCard.style.display = 'block';
            if (navMenu) navMenu.style.display = 'block';
        }
        
        // Fun√ß√£o para mostrar um card espec√≠fico por ID
        function showCardById(cardId) {
            const card = document.getElementById(cardId);
            if (card) {
                showCard(card);
                card.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }
        
        // Fun√ß√£o para mostrar um card com anima√ß√£o
        function showCard(card) {
            card.style.display = 'block';
            card.classList.add('show');
            
            // Destacar temporariamente o card
            card.style.transition = 'all 0.3s ease';
            card.style.boxShadow = '0 4px 20px rgba(0, 123, 255, 0.3)';
            card.style.borderLeft = '4px solid #007bff';
            
            setTimeout(() => {
                card.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
                card.style.borderLeft = 'none';
            }, 2000);
        }
        
        // Fun√ß√£o para mostrar mensagens tempor√°rias
        function showTemporaryMessage(title, message) {
            // Criar elemento de notifica√ß√£o
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                z-index: 9999;
                max-width: 300px;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="font-weight: bold; margin-bottom: 5px;">${title}</div>
                <div style="font-size: 14px; opacity: 0.9;">${message}</div>
            `;
            
            // Adicionar anima√ß√£o CSS
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // Remover ap√≥s 3 segundos
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s ease-in';
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.parentNode.removeChild(notification);
                    }
                    if (style.parentNode) {
                        style.parentNode.removeChild(style);
                    }
                }, 300);
            }, 3000);
        }
        
        // ========== FUN√á√ïES DOS M√ìDULOS ==========
        
        // Fun√ß√µes do m√≥dulo Clientes
        
        // Lista de clientes mock
        const clientesMock = [
            {
                id: 1,
                nome: 'Jo√£o Silva Ltda.',
                tipo: 'pj',
                documento: '12.345.678/0001-90',
                email: 'contato@joaosilva.com.br',
                telefone: '(11) 3333-4444',
                cep: '01234-567',
                endereco: 'Rua das Flores, 123, Centro, S√£o Paulo, SP',
                ativo: true
            },
            {
                id: 2,
                nome: 'Maria Santos',
                tipo: 'pf',
                documento: '123.456.789-01',
                email: 'maria.santos@email.com',
                telefone: '(11) 99999-8888',
                cep: '02345-678',
                endereco: 'Av. Paulista, 456, Bela Vista, S√£o Paulo, SP',
                ativo: true
            },
            {
                id: 3,
                nome: 'Empresa ABC S.A.',
                tipo: 'pj',
                documento: '98.765.432/0001-10',
                email: 'admin@empresaabc.com.br',
                telefone: '(11) 4444-5555',
                cep: '03456-789',
                endereco: 'Rua Comercial, 789, Vila Olimpia, S√£o Paulo, SP',
                ativo: true
            },
            {
                id: 4,
                nome: 'Carlos Oliveira',
                tipo: 'pf',
                documento: '987.654.321-09',
                email: 'carlos.oliveira@gmail.com',
                telefone: '(11) 88888-7777',
                cep: '04567-890',
                endereco: 'Rua dos Jardins, 321, Jardins, S√£o Paulo, SP',
                ativo: false
            },
            {
                id: 5,
                nome: 'TechSoft Solu√ß√µes Ltda.',
                tipo: 'pj',
                documento: '11.222.333/0001-44',
                email: 'vendas@techsoft.com.br',
                telefone: '(11) 5555-6666',
                cep: '05678-901',
                endereco: 'Av. Tecnologia, 1000, Vila Madalena, S√£o Paulo, SP',
                ativo: true
            }
        ];
        
        let selectedClienteId = null;
        
        // Fun√ß√£o para alternar entre abas
        function switchClienteTab(tab) {
            // Atualizar bot√µes das abas
            const tabButtons = document.querySelectorAll('#clientesCard .tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Atualizar conte√∫do das abas
            const tabContents = document.querySelectorAll('#clientesCard .tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'listagem') {
                tabButtons[0].classList.add('active');
                document.getElementById('clienteListagem').classList.add('active');
                loadClientesList();
            } else if (tab === 'cadastro') {
                tabButtons[1].classList.add('active');
                document.getElementById('clienteCadastro').classList.add('active');
            }
        }
        
        // Fun√ß√£o para carregar a lista de clientes
        function loadClientesList() {
            const clientesList = document.getElementById('clientesList');
            
            if (clientesMock.length === 0) {
                clientesList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h4>üìã Nenhum cliente cadastrado</h4>
                        <p>Clique em "Cadastro/Edi√ß√£o" para adicionar seu primeiro cliente.</p>
                    </div>
                `;
                return;
            }
            
            const clientesHTML = clientesMock.map(cliente => `
                <div class="item-row ${selectedClienteId === cliente.id ? 'selected' : ''}" 
                     onclick="selectCliente(${cliente.id})">
                    <div class="item-info">
                        <div class="item-name">${cliente.nome}</div>
                        <div class="item-details">
                            ${cliente.tipo === 'pf' ? 'CPF' : 'CNPJ'}: ${cliente.documento} | 
                            üìß ${cliente.email} | 
                            üì± ${cliente.telefone}
                        </div>
                    </div>
                    <div class="item-status">
                        <span class="${cliente.ativo ? 'status-active' : 'status-inactive'}">
                            ${cliente.ativo ? 'üü¢ Ativo' : 'üî¥ Inativo'}
                        </span>
                    </div>
                </div>
            `).join('');
            
            clientesList.innerHTML = clientesHTML;
        }
        
        // Fun√ß√£o para selecionar um cliente da lista
        function selectCliente(clienteId) {
            selectedClienteId = clienteId;
            const cliente = clientesMock.find(c => c.id === clienteId);
            
            if (cliente) {
                // Preencher o formul√°rio com os dados do cliente
                document.getElementById('clienteNome').value = cliente.nome;
                document.getElementById('clienteTipo').value = cliente.tipo;
                document.getElementById('clienteDocumento').value = cliente.documento;
                document.getElementById('clienteEmail').value = cliente.email;
                document.getElementById('clienteTelefone').value = cliente.telefone;
                document.getElementById('clienteCep').value = cliente.cep;
                document.getElementById('clienteEndereco').value = cliente.endereco;
                
                // Alternar para a aba de cadastro
                switchClienteTab('cadastro');
                
                // Atualizar a lista para mostrar o item selecionado
                loadClientesList();
                
                showTemporaryMessage('üë• Cliente', `Cliente "${cliente.nome}" carregado para edi√ß√£o`);
            }
        }
        
        function salvarCliente() {
            const nome = document.getElementById('clienteNome').value;
            const tipo = document.getElementById('clienteTipo').value;
            const documento = document.getElementById('clienteDocumento').value;
            const email = document.getElementById('clienteEmail').value;
            const telefone = document.getElementById('clienteTelefone').value;
            const cep = document.getElementById('clienteCep').value;
            const endereco = document.getElementById('clienteEndereco').value;
            
            if (!nome || !tipo || !documento) {
                alert('Por favor, preencha os campos obrigat√≥rios: Nome, Tipo e CPF/CNPJ');
                return;
            }
            
            const clienteData = {
                nome, tipo, documento, email, telefone, cep, endereco, ativo: true
            };
            
            if (selectedClienteId) {
                // Editar cliente existente
                const index = clientesMock.findIndex(c => c.id === selectedClienteId);
                if (index !== -1) {
                    clientesMock[index] = { ...clientesMock[index], ...clienteData };
                    showTemporaryMessage('üë• Cliente', 'Cliente atualizado com sucesso!');
                }
            } else {
                // Criar novo cliente
                const novoId = Math.max(...clientesMock.map(c => c.id)) + 1;
                clientesMock.push({ id: novoId, ...clienteData });
                showTemporaryMessage('ÔøΩ Cliente', 'Cliente cadastrado com sucesso!');
            }
            
            // Limpar sele√ß√£o e voltar para listagem
            selectedClienteId = null;
            limparFormCliente();
            switchClienteTab('listagem');
        }
        
        function novoCliente() {
            selectedClienteId = null;
            limparFormCliente();
            switchClienteTab('cadastro');
            showTemporaryMessage('‚ûï Novo', 'Formul√°rio preparado para novo cliente');
        }
        
        function limparFormCliente() {
            document.getElementById('clienteNome').value = '';
            document.getElementById('clienteTipo').value = '';
            document.getElementById('clienteDocumento').value = '';
            document.getElementById('clienteEmail').value = '';
            document.getElementById('clienteTelefone').value = '';
            document.getElementById('clienteCep').value = '';
            document.getElementById('clienteEndereco').value = '';
            
            selectedClienteId = null;
            loadClientesList(); // Atualizar lista para remover sele√ß√£o
        }
        
        // Mock data para produtos
        let produtosMock = [
            {
                id: 1,
                codigo: 'ELE001',
                nome: 'Smartphone Samsung Galaxy A54',
                ean: '7891234567890',
                referencia: 'SM-A545F',
                quantidade: 25,
                categoria: 'eletronicos',
                descricao: 'Smartphone Samsung Galaxy A54 5G 128GB, Tela 6.4", C√¢mera Tripla 50MP, Android 13',
                ativo: true
            },
            {
                id: 2,
                codigo: 'ROU001',
                nome: 'Camiseta Polo Masculina',
                ean: '7890123456789',
                referencia: 'POLO-M-AZ',
                quantidade: 50,
                categoria: 'roupas',
                descricao: 'Camiseta Polo masculina 100% algod√£o, cor azul marinho, tamanhos P ao GG',
                ativo: true
            },
            {
                id: 3,
                codigo: 'LIV001',
                nome: 'Clean Code - C√≥digo Limpo',
                ean: '9788576082675',
                referencia: 'LIV-CC-2019',
                quantidade: 15,
                categoria: 'livros',
                descricao: 'Livro Clean Code de Robert C. Martin - Habilidades Pr√°ticas do Agile Software',
                ativo: true
            },
            {
                id: 4,
                codigo: 'CAS001',
                nome: 'Aspirador de P√≥ Vertical',
                ean: '7892345678901',
                referencia: 'ASP-VER-1200W',
                quantidade: 8,
                categoria: 'casa',
                descricao: 'Aspirador de p√≥ vertical sem fio, 1200W, filtro HEPA, autonomia 45 minutos',
                ativo: true
            },
            {
                id: 5,
                codigo: 'ESP001',
                nome: 'Bola de Futebol Oficial',
                ean: '7893456789012',
                referencia: 'BOLA-FUT-OFF',
                quantidade: 30,
                categoria: 'esportes',
                descricao: 'Bola de futebol oficial FIFA Quality Pro, couro sint√©tico, costurada √† m√£o',
                ativo: true
            },
            {
                id: 6,
                codigo: 'BEL001',
                nome: 'Kit Maquiagem Completo',
                ean: '7894567890123',
                referencia: 'KIT-MAQ-PRO',
                quantidade: 12,
                categoria: 'beleza',
                descricao: 'Kit de maquiagem profissional com 50 itens: bases, sombras, batons e pinc√©is',
                ativo: false
            }
        ];
        
        let selectedProductId = null;
        
        // Fun√ß√£o para alternar entre abas dos produtos
        function switchProductTab(tab) {
            // Atualizar bot√µes das abas
            const tabButtons = document.querySelectorAll('#produtosCard .tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Atualizar conte√∫do das abas
            const tabContents = document.querySelectorAll('#produtosCard .tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'listagem') {
                tabButtons[0].classList.add('active');
                document.getElementById('productListagem').classList.add('active');
                loadProductsList();
            } else if (tab === 'cadastro') {
                tabButtons[1].classList.add('active');
                document.getElementById('productCadastro').classList.add('active');
            }
        }
        
        // Fun√ß√£o para carregar a lista de produtos
        function loadProductsList() {
            const productsList = document.getElementById('productsList');
            
            if (produtosMock.length === 0) {
                productsList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h4>üì¶ Nenhum produto cadastrado</h4>
                        <p>Clique em "Cadastro/Edi√ß√£o" para adicionar seu primeiro produto.</p>
                    </div>
                `;
                return;
            }
            
            const productsHTML = produtosMock.map(produto => `
                <div class="item-row ${selectedProductId === produto.id ? 'selected' : ''}" 
                     onclick="selectProduct(${produto.id})">
                    <div class="item-info">
                        <div class="item-name">${produto.nome}</div>
                        <div class="item-details">
                            C√≥digo: ${produto.codigo} | 
                            EAN: ${produto.ean} | 
                            Estoque: ${produto.quantidade} unid. | 
                            üì¶ ${getCategoryName(produto.categoria)}
                        </div>
                    </div>
                    <div class="item-status">
                        <span class="${produto.ativo ? 'status-active' : 'status-inactive'}">
                            ${produto.ativo ? 'üü¢ Ativo' : 'üî¥ Inativo'}
                        </span>
                    </div>
                </div>
            `).join('');
            
            productsList.innerHTML = productsHTML;
        }
        
        // Fun√ß√£o auxiliar para obter nome da categoria
        function getCategoryName(categoria) {
            const categorias = {
                'eletronicos': 'Eletr√¥nicos',
                'roupas': 'Roupas',
                'livros': 'Livros',
                'casa': 'Casa e Jardim',
                'esportes': 'Esportes',
                'beleza': 'Beleza e Cuidados'
            };
            return categorias[categoria] || categoria;
        }
        
        // Fun√ß√£o para selecionar um produto da lista
        function selectProduct(productId) {
            selectedProductId = productId;
            const produto = produtosMock.find(p => p.id === productId);
            
            if (produto) {
                // Preencher o formul√°rio com os dados do produto
                document.getElementById('productCode').value = produto.codigo;
                document.getElementById('productName').value = produto.nome;
                document.getElementById('productEan').value = produto.ean;
                document.getElementById('productRef').value = produto.referencia;
                document.getElementById('productQty').value = produto.quantidade;
                document.getElementById('productCategory').value = produto.categoria;
                document.getElementById('productDesc').value = produto.descricao;
                
                // Alternar para a aba de cadastro
                switchProductTab('cadastro');
                
                // Atualizar a lista para mostrar o item selecionado
                loadProductsList();
                
                showTemporaryMessage('üì¶ Produto', `Produto "${produto.nome}" carregado para edi√ß√£o`);
            }
        }
        
        function salvarProduto() {
            const codigo = document.getElementById('productCode').value;
            const nome = document.getElementById('productName').value;
            const ean = document.getElementById('productEan').value;
            const referencia = document.getElementById('productRef').value;
            const quantidade = document.getElementById('productQty').value;
            const categoria = document.getElementById('productCategory').value;
            const descricao = document.getElementById('productDesc').value;
            
            if (!codigo || !nome || !categoria) {
                alert('Por favor, preencha os campos obrigat√≥rios: C√≥digo, Nome e Categoria');
                return;
            }
            
            const productData = {
                codigo, nome, ean, referencia, 
                quantidade: parseInt(quantidade) || 0, 
                categoria, descricao, ativo: true
            };
            
            if (selectedProductId) {
                // Editar produto existente
                const index = produtosMock.findIndex(p => p.id === selectedProductId);
                if (index !== -1) {
                    produtosMock[index] = { ...produtosMock[index], ...productData };
                    showTemporaryMessage('üì¶ Produto', 'Produto atualizado com sucesso!');
                }
            } else {
                // Criar novo produto
                const novoId = Math.max(...produtosMock.map(p => p.id)) + 1;
                produtosMock.push({ id: novoId, ...productData });
                showTemporaryMessage('üì¶ Produto', 'Produto cadastrado com sucesso!');
            }
            
            // Limpar sele√ß√£o e voltar para listagem
            selectedProductId = null;
            limparFormProduto();
            switchProductTab('listagem');
        }
        
        function novoProduto() {
            selectedProductId = null;
            limparFormProduto();
            switchProductTab('cadastro');
            showTemporaryMessage('‚ûï Novo', 'Formul√°rio preparado para novo produto');
        }
        
        function limparFormProduto() {
            document.getElementById('productCode').value = '';
            document.getElementById('productName').value = '';
            document.getElementById('productEan').value = '';
            document.getElementById('productRef').value = '';
            document.getElementById('productQty').value = '';
            document.getElementById('productCategory').value = '';
            document.getElementById('productDesc').value = '';
            
            // Limpar preview de imagem
            const imagePreview = document.getElementById('imagePreview');
            if (imagePreview) {
                imagePreview.innerHTML = '<span style="color: #999;">Sem imagem</span>';
            }
            
            selectedProductId = null;
            loadProductsList(); // Atualizar lista para remover sele√ß√£o
        }
        
        // Mock data para transportadoras
        let transportadorasMock = [
            {
                id: 1,
                nome: 'Transportes R√°pidos Ltda.',
                cnpj: '12.345.678/0001-90',
                contato: 'Carlos Silva',
                telefone: '(11) 3333-4444',
                email: 'contato@transportesrapidos.com.br',
                regiao: 'nacional',
                observacoes: 'Especializada em cargas fr√°geis e eletr√¥nicos. Entrega expressa dispon√≠vel.',
                ativo: true
            },
            {
                id: 2,
                nome: 'Log√≠stica Express S.A.',
                cnpj: '98.765.432/0001-10',
                contato: 'Ana Santos',
                telefone: '(11) 5555-6666',
                email: 'vendas@logisticaexpress.com',
                regiao: 'regional',
                observacoes: 'Foco em entregas regionais r√°pidas. Rastreamento em tempo real.',
                ativo: true
            },
            {
                id: 3,
                nome: 'Global Transportes Internacionais',
                cnpj: '11.222.333/0001-44',
                contato: 'Roberto Costa',
                telefone: '(11) 7777-8888',
                email: 'internacional@globaltransportes.com.br',
                regiao: 'internacional',
                observacoes: 'Especializada em importa√ß√£o e exporta√ß√£o. Documenta√ß√£o completa.',
                ativo: true
            },
            {
                id: 4,
                nome: 'Entrega Local SP',
                cnpj: '55.666.777/0001-88',
                contato: 'Maria Oliveira',
                telefone: '(11) 9999-0000',
                email: 'local@entregasp.com.br',
                regiao: 'local',
                observacoes: 'Entregas apenas na Grande S√£o Paulo. Servi√ßo same-day dispon√≠vel.',
                ativo: false
            }
        ];
        
        let selectedTransportadoraId = null;
        
        // Fun√ß√£o para alternar entre abas das transportadoras
        function switchTransportadoraTab(tab) {
            // Atualizar bot√µes das abas
            const tabButtons = document.querySelectorAll('#transportadorasCard .tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Atualizar conte√∫do das abas
            const tabContents = document.querySelectorAll('#transportadorasCard .tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'listagem') {
                tabButtons[0].classList.add('active');
                document.getElementById('transportadoraListagem').classList.add('active');
                loadTransportadorasList();
            } else if (tab === 'cadastro') {
                tabButtons[1].classList.add('active');
                document.getElementById('transportadoraCadastro').classList.add('active');
            }
        }
        
        // Fun√ß√£o para carregar a lista de transportadoras
        function loadTransportadorasList() {
            const transportadorasList = document.getElementById('transportadorasList');
            
            if (transportadorasMock.length === 0) {
                transportadorasList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h4>üöö Nenhuma transportadora cadastrada</h4>
                        <p>Clique em "Cadastro/Edi√ß√£o" para adicionar sua primeira transportadora.</p>
                    </div>
                `;
                return;
            }
            
            const transportadorasHTML = transportadorasMock.map(transportadora => `
                <div class="item-row ${selectedTransportadoraId === transportadora.id ? 'selected' : ''}" 
                     onclick="selectTransportadora(${transportadora.id})">
                    <div class="item-info">
                        <div class="item-name">${transportadora.nome}</div>
                        <div class="item-details">
                            CNPJ: ${transportadora.cnpj} | 
                            üìû ${transportadora.telefone} | 
                            üë§ ${transportadora.contato} | 
                            üåç ${getRegiaoName(transportadora.regiao)}
                        </div>
                    </div>
                    <div class="item-status">
                        <span class="${transportadora.ativo ? 'status-active' : 'status-inactive'}">
                            ${transportadora.ativo ? 'üü¢ Ativo' : 'üî¥ Inativo'}
                        </span>
                    </div>
                </div>
            `).join('');
            
            transportadorasList.innerHTML = transportadorasHTML;
        }
        
        // Fun√ß√£o auxiliar para obter nome da regi√£o
        function getRegiaoName(regiao) {
            const regioes = {
                'local': 'Local',
                'regional': 'Regional',
                'nacional': 'Nacional',
                'internacional': 'Internacional'
            };
            return regioes[regiao] || regiao;
        }
        
        // Fun√ß√£o para selecionar uma transportadora da lista
        function selectTransportadora(transportadoraId) {
            selectedTransportadoraId = transportadoraId;
            const transportadora = transportadorasMock.find(t => t.id === transportadoraId);
            
            if (transportadora) {
                // Preencher o formul√°rio com os dados da transportadora
                document.getElementById('transpNome').value = transportadora.nome;
                document.getElementById('transpCnpj').value = transportadora.cnpj;
                document.getElementById('transpContato').value = transportadora.contato;
                document.getElementById('transpTelefone').value = transportadora.telefone;
                document.getElementById('transpEmail').value = transportadora.email;
                document.getElementById('transpRegiao').value = transportadora.regiao;
                document.getElementById('transpObservacoes').value = transportadora.observacoes;
                
                // Alternar para a aba de cadastro
                switchTransportadoraTab('cadastro');
                
                // Atualizar a lista para mostrar o item selecionado
                loadTransportadorasList();
                
                showTemporaryMessage('üöö Transportadora', `Transportadora "${transportadora.nome}" carregada para edi√ß√£o`);
            }
        }
        
        function salvarTransportadora() {
            const nome = document.getElementById('transpNome').value;
            const cnpj = document.getElementById('transpCnpj').value;
            const contato = document.getElementById('transpContato').value;
            const telefone = document.getElementById('transpTelefone').value;
            const email = document.getElementById('transpEmail').value;
            const regiao = document.getElementById('transpRegiao').value;
            const observacoes = document.getElementById('transpObservacoes').value;
            
            if (!nome || !cnpj) {
                alert('Por favor, preencha os campos obrigat√≥rios: Nome e CNPJ');
                return;
            }
            
            const transportadoraData = {
                nome, cnpj, contato, telefone, email, regiao, observacoes, ativo: true
            };
            
            if (selectedTransportadoraId) {
                // Editar transportadora existente
                const index = transportadorasMock.findIndex(t => t.id === selectedTransportadoraId);
                if (index !== -1) {
                    transportadorasMock[index] = { ...transportadorasMock[index], ...transportadoraData };
                    showTemporaryMessage('üöö Transportadora', 'Transportadora atualizada com sucesso!');
                }
            } else {
                // Criar nova transportadora
                const novoId = Math.max(...transportadorasMock.map(t => t.id)) + 1;
                transportadorasMock.push({ id: novoId, ...transportadoraData });
                showTemporaryMessage('üöö Transportadora', 'Transportadora cadastrada com sucesso!');
            }
            
            // Limpar sele√ß√£o e voltar para listagem
            selectedTransportadoraId = null;
            limparFormTransportadora();
            switchTransportadoraTab('listagem');
        }
        
        function novaTransportadora() {
            selectedTransportadoraId = null;
            limparFormTransportadora();
            switchTransportadoraTab('cadastro');
            showTemporaryMessage('‚ûï Novo', 'Formul√°rio preparado para nova transportadora');
        }
        
        function limparFormTransportadora() {
            document.getElementById('transpNome').value = '';
            document.getElementById('transpCnpj').value = '';
            document.getElementById('transpContato').value = '';
            document.getElementById('transpTelefone').value = '';
            document.getElementById('transpEmail').value = '';
            document.getElementById('transpRegiao').value = '';
            document.getElementById('transpObservacoes').value = '';
            
            selectedTransportadoraId = null;
            loadTransportadorasList(); // Atualizar lista para remover sele√ß√£o
        }
        
        // Mock data para vendas
        let vendasMock = [
            {
                id: 1,
                numero: 'VEN001',
                cliente: { id: 1, nome: 'Jo√£o Silva Ltda.' },
                vendedor: { id: 1, nome: 'Carlos Vendas' },
                data: '2024-08-05',
                formaPagamento: 'cartao',
                observacoes: 'Venda realizada com desconto de 5% para cliente fidelizado',
                produtos: [
                    { id: 1, nome: 'Smartphone Samsung Galaxy A54', quantidade: 2, precoUnitario: 899.99, subtotal: 1799.98 },
                    { id: 3, nome: 'Clean Code - C√≥digo Limpo', quantidade: 1, precoUnitario: 89.90, subtotal: 89.90 }
                ],
                total: 1889.88,
                status: 'finalizada'
            },
            {
                id: 2,
                numero: 'VEN002',
                cliente: { id: 2, nome: 'Maria Santos' },
                vendedor: { id: 2, nome: 'Ana Comercial' },
                data: '2024-08-06',
                formaPagamento: 'pix',
                observacoes: 'Entrega expressa solicitada pelo cliente',
                produtos: [
                    { id: 2, nome: 'Camiseta Polo Masculina', quantidade: 3, precoUnitario: 79.90, subtotal: 239.70 },
                    { id: 5, nome: 'Bola de Futebol Oficial', quantidade: 1, precoUnitario: 149.99, subtotal: 149.99 }
                ],
                total: 389.69,
                status: 'finalizada'
            },
            {
                id: 3,
                numero: 'VEN003',
                cliente: { id: 3, nome: 'Empresa ABC S.A.' },
                vendedor: { id: 3, nome: 'Pedro Neg√≥cios' },
                data: '2024-08-07',
                formaPagamento: 'boleto',
                observacoes: 'Venda corporativa - prazo de pagamento 30 dias',
                produtos: [
                    { id: 4, nome: 'Aspirador de P√≥ Vertical', quantidade: 5, precoUnitario: 599.99, subtotal: 2999.95 },
                    { id: 6, nome: 'Kit Maquiagem Completo', quantidade: 10, precoUnitario: 199.90, subtotal: 1999.00 }
                ],
                total: 4998.95,
                status: 'pendente'
            }
        ];
        
        let selectedVendaId = null;
        let produtosVendaAtual = [];
        
        // Fun√ß√£o para alternar entre abas das vendas
        function switchVendaTab(tab) {
            // Atualizar bot√µes das abas
            const tabButtons = document.querySelectorAll('#vendasCard .tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Atualizar conte√∫do das abas
            const tabContents = document.querySelectorAll('#vendasCard .tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'listagem') {
                tabButtons[0].classList.add('active');
                document.getElementById('vendaListagem').classList.add('active');
                loadVendasList();
            } else if (tab === 'cadastro') {
                tabButtons[1].classList.add('active');
                document.getElementById('vendaCadastro').classList.add('active');
            }
        }
        
        // Fun√ß√£o para carregar a lista de vendas
        function loadVendasList() {
            const vendasList = document.getElementById('vendasList');
            
            if (vendasMock.length === 0) {
                vendasList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h4>üí∞ Nenhuma venda cadastrada</h4>
                        <p>Clique em "Cadastro/Edi√ß√£o" para registrar sua primeira venda.</p>
                    </div>
                `;
                return;
            }
            
            const vendasHTML = vendasMock.map(venda => `
                <div class="item-row ${selectedVendaId === venda.id ? 'selected' : ''}" 
                     onclick="selectVenda(${venda.id})">
                    <div class="item-info">
                        <div class="item-name">${venda.numero} - ${venda.cliente.nome}</div>
                        <div class="item-details">
                            üìÖ ${formatDate(venda.data)} | 
                            üë§ ${venda.vendedor.nome} | 
                            üí≥ ${getFormaPagamentoName(venda.formaPagamento)} | 
                            üõí ${venda.produtos.length} item(ns) | 
                            üí∞ R$ ${venda.total.toFixed(2).replace('.', ',')}
                        </div>
                    </div>
                    <div class="item-status">
                        <span class="${venda.status === 'finalizada' ? 'status-active' : 'status-inactive'}">
                            ${venda.status === 'finalizada' ? '‚úÖ Finalizada' : '‚è≥ Pendente'}
                        </span>
                    </div>
                </div>
            `).join('');
            
            vendasList.innerHTML = vendasHTML;
        }
        
        // Fun√ß√£o auxiliar para formatar data
        function formatDate(dateString) {
            const date = new Date(dateString + 'T00:00:00');
            return date.toLocaleDateString('pt-BR');
        }
        
        // Fun√ß√£o auxiliar para obter nome da forma de pagamento
        function getFormaPagamentoName(forma) {
            const formas = {
                'dinheiro': 'Dinheiro',
                'cartao': 'Cart√£o',
                'pix': 'PIX',
                'boleto': 'Boleto'
            };
            return formas[forma] || forma;
        }
        
        // Fun√ß√£o para selecionar uma venda da lista
        function selectVenda(vendaId) {
            selectedVendaId = vendaId;
            const venda = vendasMock.find(v => v.id === vendaId);
            
            if (venda) {
                // Preencher o formul√°rio com os dados da venda
                document.getElementById('vendaNumero').value = venda.numero;
                document.getElementById('vendaCliente').value = venda.cliente.id;
                document.getElementById('vendaVendedor').value = venda.vendedor.id;
                document.getElementById('vendaData').value = venda.data;
                document.getElementById('vendaFormaPagamento').value = venda.formaPagamento;
                document.getElementById('vendaTotal').value = venda.total.toFixed(2);
                document.getElementById('vendaObservacoes').value = venda.observacoes;
                
                // Carregar produtos da venda
                produtosVendaAtual = [...venda.produtos];
                updateProdutosVendaLista();
                
                // Alternar para a aba de cadastro
                switchVendaTab('cadastro');
                
                // Atualizar a lista para mostrar o item selecionado
                loadVendasList();
                
                showTemporaryMessage('üí∞ Venda', `Venda "${venda.numero}" carregada para edi√ß√£o`);
            }
        }
        
        // Fun√ß√£o para adicionar produto √† venda
        function adicionarProdutoVenda() {
            const produtoSelect = document.getElementById('vendaProduto');
            const quantidadeInput = document.getElementById('vendaQuantidade');
            const precoInput = document.getElementById('vendaPrecoUnitario');
            
            const produtoId = produtoSelect.value;
            const produtoNome = produtoSelect.selectedOptions[0]?.text;
            const quantidade = parseInt(quantidadeInput.value) || 1;
            const precoUnitario = parseFloat(precoInput.value) || 0;
            
            if (!produtoId || !produtoNome || precoUnitario <= 0) {
                alert('Por favor, selecione um produto, quantidade e pre√ßo v√°lidos');
                return;
            }
            
            // Verificar se produto j√° existe na lista
            const produtoExistente = produtosVendaAtual.find(p => p.id == produtoId);
            if (produtoExistente) {
                // Atualizar quantidade e pre√ßo
                produtoExistente.quantidade += quantidade;
                produtoExistente.precoUnitario = precoUnitario;
                produtoExistente.subtotal = produtoExistente.quantidade * precoUnitario;
            } else {
                // Adicionar novo produto
                const novoProduto = {
                    id: parseInt(produtoId),
                    nome: produtoNome,
                    quantidade: quantidade,
                    precoUnitario: precoUnitario,
                    subtotal: quantidade * precoUnitario
                };
                produtosVendaAtual.push(novoProduto);
            }
            
            // Limpar campos
            produtoSelect.value = '';
            quantidadeInput.value = '1';
            precoInput.value = '';
            
            // Atualizar lista e total
            updateProdutosVendaLista();
            calcularTotalVenda();
            
            showTemporaryMessage('üõí Produto', 'Produto adicionado √† venda');
        }
        
        // Fun√ß√£o para atualizar a lista de produtos da venda
        function updateProdutosVendaLista() {
            const lista = document.getElementById('produtosVendaLista');
            
            if (produtosVendaAtual.length === 0) {
                lista.innerHTML = '<p style="color: #6c757d; font-style: italic; margin: 10px 0;">Nenhum produto adicionado</p>';
                return;
            }
            
            const produtosHTML = produtosVendaAtual.map((produto, index) => `
                <div class="produto-venda-item" style="display: flex; justify-content: space-between; align-items: center; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px; margin: 5px 0; background: #f8f9fa;">
                    <div>
                        <strong>${produto.nome}</strong><br>
                        <small>Qtd: ${produto.quantidade} | Pre√ßo: R$ ${produto.precoUnitario.toFixed(2).replace('.', ',')} | Subtotal: R$ ${produto.subtotal.toFixed(2).replace('.', ',')}</small>
                    </div>
                    <button type="button" onclick="removerProdutoVenda(${index})" style="background: #dc3545; color: white; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer;">üóëÔ∏è</button>
                </div>
            `).join('');
            
            lista.innerHTML = produtosHTML;
        }
        
        // Fun√ß√£o para remover produto da venda
        function removerProdutoVenda(index) {
            produtosVendaAtual.splice(index, 1);
            updateProdutosVendaLista();
            calcularTotalVenda();
            showTemporaryMessage('üóëÔ∏è Produto', 'Produto removido da venda');
        }
        
        // Fun√ß√£o para calcular total da venda
        function calcularTotalVenda() {
            const total = produtosVendaAtual.reduce((sum, produto) => sum + produto.subtotal, 0);
            document.getElementById('vendaTotal').value = total.toFixed(2);
        }
        
        function salvarVenda() {
            const numero = document.getElementById('vendaNumero').value;
            const clienteId = document.getElementById('vendaCliente').value;
            const vendedorId = document.getElementById('vendaVendedor').value;
            const data = document.getElementById('vendaData').value;
            const formaPagamento = document.getElementById('vendaFormaPagamento').value;
            const observacoes = document.getElementById('vendaObservacoes').value;
            
            if (!numero || !clienteId || !vendedorId || !data || !formaPagamento) {
                alert('Por favor, preencha os campos obrigat√≥rios: N√∫mero, Cliente, Vendedor, Data e Forma de Pagamento');
                return;
            }
            
            if (produtosVendaAtual.length === 0) {
                alert('Por favor, adicione pelo menos um produto √† venda');
                return;
            }
            
            const clienteSelect = document.getElementById('vendaCliente');
            const vendedorSelect = document.getElementById('vendaVendedor');
            const total = produtosVendaAtual.reduce((sum, produto) => sum + produto.subtotal, 0);
            
            const vendaData = {
                numero,
                cliente: {
                    id: parseInt(clienteId),
                    nome: clienteSelect.selectedOptions[0]?.text || 'Cliente'
                },
                vendedor: {
                    id: parseInt(vendedorId),
                    nome: vendedorSelect.selectedOptions[0]?.text || 'Vendedor'
                },
                data,
                formaPagamento,
                observacoes,
                produtos: [...produtosVendaAtual],
                total,
                status: 'finalizada'
            };
            
            if (selectedVendaId) {
                // Editar venda existente
                const index = vendasMock.findIndex(v => v.id === selectedVendaId);
                if (index !== -1) {
                    vendasMock[index] = { ...vendasMock[index], ...vendaData };
                    showTemporaryMessage('üí∞ Venda', 'Venda atualizada com sucesso!');
                }
            } else {
                // Criar nova venda
                const novoId = Math.max(...vendasMock.map(v => v.id)) + 1;
                vendasMock.push({ id: novoId, ...vendaData });
                showTemporaryMessage('üí∞ Venda', 'Venda cadastrada com sucesso!');
            }
            
            // Limpar sele√ß√£o e voltar para listagem
            selectedVendaId = null;
            produtosVendaAtual = [];
            limparFormVenda();
            switchVendaTab('listagem');
        }
        
        function novaVenda() {
            selectedVendaId = null;
            produtosVendaAtual = [];
            limparFormVenda();
            switchVendaTab('cadastro');
            // Auto-gerar n√∫mero da venda
            document.getElementById('vendaNumero').value = 'VEN' + String(Date.now()).slice(-6);
            document.getElementById('vendaData').value = new Date().toISOString().split('T')[0];
            showTemporaryMessage('‚ûï Nova', 'Formul√°rio preparado para nova venda');
        }
        
        function limparFormVenda() {
            document.getElementById('vendaNumero').value = '';
            document.getElementById('vendaCliente').value = '';
            document.getElementById('vendaVendedor').value = '';
            document.getElementById('vendaData').value = '';
            document.getElementById('vendaFormaPagamento').value = '';
            document.getElementById('vendaTotal').value = '';
            document.getElementById('vendaObservacoes').value = '';
            
            // Limpar produtos da venda
            produtosVendaAtual = [];
            updateProdutosVendaLista();
            
            selectedVendaId = null;
            loadVendasList(); // Atualizar lista para remover sele√ß√£o
        }
        
        // Mock data para notas fiscais
        let notasFiscaisMock = [
            {
                id: 1,
                numero: '000001',
                serie: '1',
                tipo: 'nfe',
                operacao: 'venda',
                cliente: { id: 1, nome: 'Jo√£o Silva Ltda.' },
                dataEmissao: '2024-08-05',
                status: 'autorizada',
                observacoes: 'Nota fiscal referente √† venda VEN001. Prazo de entrega: 5 dias √∫teis.',
                produtos: [
                    { id: 1, nome: 'Smartphone Samsung Galaxy A54', quantidade: 2, precoUnitario: 899.99, subtotal: 1799.98 },
                    { id: 3, nome: 'Clean Code - C√≥digo Limpo', quantidade: 1, precoUnitario: 89.90, subtotal: 89.90 }
                ],
                total: 1889.88,
                chaveAcesso: '35240812345678000190550010000000011234567890'
            },
            {
                id: 2,
                numero: '000002',
                serie: '1',
                tipo: 'nfce',
                operacao: 'venda',
                cliente: { id: 2, nome: 'Maria Santos' },
                dataEmissao: '2024-08-06',
                status: 'autorizada',
                observacoes: 'Venda no balc√£o. Entrega expressa solicitada.',
                produtos: [
                    { id: 2, nome: 'Camiseta Polo Masculina', quantidade: 3, precoUnitario: 79.90, subtotal: 239.70 },
                    { id: 5, nome: 'Bola de Futebol Oficial', quantidade: 1, precoUnitario: 149.99, subtotal: 149.99 }
                ],
                total: 389.69,
                chaveAcesso: '35240812345678000190650010000000021234567891'
            },
            {
                id: 3,
                numero: '000003',
                serie: '1',
                tipo: 'nfe',
                operacao: 'venda',
                cliente: { id: 3, nome: 'Empresa ABC S.A.' },
                dataEmissao: '2024-08-07',
                status: 'autorizada',
                observacoes: 'Venda corporativa. Faturamento mensal conforme contrato.',
                produtos: [
                    { id: 4, nome: 'Aspirador de P√≥ Vertical', quantidade: 5, precoUnitario: 599.99, subtotal: 2999.95 },
                    { id: 6, nome: 'Kit Maquiagem Completo', quantidade: 10, precoUnitario: 199.90, subtotal: 1999.00 }
                ],
                total: 4998.95,
                chaveAcesso: '35240812345678000190550010000000031234567892'
            },
            {
                id: 4,
                numero: '000004',
                serie: '1',
                tipo: 'nfe',
                operacao: 'devolucao',
                cliente: { id: 4, nome: 'Carlos Oliveira' },
                dataEmissao: '2024-08-08',
                status: 'cancelada',
                observacoes: 'Nota fiscal de devolu√ß√£o cancelada devido a erro nos dados do cliente.',
                produtos: [
                    { id: 1, nome: 'Smartphone Samsung Galaxy A54', quantidade: 1, precoUnitario: 899.99, subtotal: 899.99 }
                ],
                total: 899.99,
                chaveAcesso: '35240812345678000190550010000000041234567893'
            }
        ];
        
        let selectedNotaFiscalId = null;
        let produtosNFAtual = [];
        
        // Fun√ß√£o para alternar entre abas das notas fiscais
        function switchNotaFiscalTab(tab) {
            // Atualizar bot√µes das abas
            const tabButtons = document.querySelectorAll('#notasFiscaisCard .tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Atualizar conte√∫do das abas
            const tabContents = document.querySelectorAll('#notasFiscaisCard .tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'listagem') {
                tabButtons[0].classList.add('active');
                document.getElementById('notaFiscalListagem').classList.add('active');
                loadNotasFiscaisList();
            } else if (tab === 'cadastro') {
                tabButtons[1].classList.add('active');
                document.getElementById('notaFiscalCadastro').classList.add('active');
            }
        }
        
        // Fun√ß√£o para carregar a lista de notas fiscais
        function loadNotasFiscaisList() {
            const notasFiscaisList = document.getElementById('notasFiscaisList');
            
            if (notasFiscaisMock.length === 0) {
                notasFiscaisList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h4>üìÑ Nenhuma nota fiscal cadastrada</h4>
                        <p>Clique em "Cadastro/Edi√ß√£o" para emitir sua primeira nota fiscal.</p>
                    </div>
                `;
                return;
            }
            
            const notasHTML = notasFiscaisMock.map(nota => `
                <div class="item-row ${selectedNotaFiscalId === nota.id ? 'selected' : ''}" 
                     onclick="selectNotaFiscal(${nota.id})">
                    <div class="item-info">
                        <div class="item-name">NF ${nota.numero}/${nota.serie} - ${nota.cliente.nome}</div>
                        <div class="item-details">
                            üìÖ ${formatDate(nota.dataEmissao)} | 
                            üìÑ ${getTipoNFName(nota.tipo)} | 
                            üîÑ ${getOperacaoName(nota.operacao)} | 
                            üõí ${nota.produtos.length} item(ns) | 
                            üí∞ R$ ${nota.total.toFixed(2).replace('.', ',')}
                        </div>
                    </div>
                    <div class="item-status">
                        <span class="${getStatusNFClass(nota.status)}">
                            ${getStatusNFIcon(nota.status)} ${getStatusNFName(nota.status)}
                        </span>
                    </div>
                </div>
            `).join('');
            
            notasFiscaisList.innerHTML = notasHTML;
        }
        
        // Fun√ß√µes auxiliares para nomes e status
        function getTipoNFName(tipo) {
            const tipos = {
                'nfe': 'NF-e',
                'nfce': 'NFC-e',
                'nfse': 'NFS-e'
            };
            return tipos[tipo] || tipo;
        }
        
        function getOperacaoName(operacao) {
            const operacoes = {
                'venda': 'Venda',
                'devolucao': 'Devolu√ß√£o',
                'transferencia': 'Transfer√™ncia',
                'servico': 'Servi√ßo'
            };
            return operacoes[operacao] || operacao;
        }
        
        function getStatusNFName(status) {
            const statusMap = {
                'rascunho': 'Rascunho',
                'autorizada': 'Autorizada',
                'cancelada': 'Cancelada',
                'inutilizada': 'Inutilizada'
            };
            return statusMap[status] || status;
        }
        
        function getStatusNFIcon(status) {
            const icons = {
                'rascunho': 'üìù',
                'autorizada': '‚úÖ',
                'cancelada': '‚ùå',
                'inutilizada': 'üö´'
            };
            return icons[status] || '‚ùì';
        }
        
        function getStatusNFClass(status) {
            const classes = {
                'rascunho': 'status-warning',
                'autorizada': 'status-active',
                'cancelada': 'status-inactive',
                'inutilizada': 'status-inactive'
            };
            return classes[status] || 'status-inactive';
        }
        
        // Fun√ß√£o para selecionar uma nota fiscal da lista
        function selectNotaFiscal(notaId) {
            selectedNotaFiscalId = notaId;
            const nota = notasFiscaisMock.find(n => n.id === notaId);
            
            if (nota) {
                // Preencher o formul√°rio com os dados da nota fiscal
                document.getElementById('nfNumero').value = nota.numero;
                document.getElementById('nfSerie').value = nota.serie;
                document.getElementById('nfTipo').value = nota.tipo;
                document.getElementById('nfOperacao').value = nota.operacao;
                document.getElementById('nfCliente').value = nota.cliente.id;
                document.getElementById('nfDataEmissao').value = nota.dataEmissao;
                document.getElementById('nfValor').value = nota.total.toFixed(2);
                document.getElementById('nfStatus').value = nota.status;
                document.getElementById('nfObservacoes').value = nota.observacoes;
                
                // Carregar produtos da nota fiscal
                produtosNFAtual = [...nota.produtos];
                updateProdutosNFLista();
                
                // Alternar para a aba de cadastro
                switchNotaFiscalTab('cadastro');
                
                // Atualizar a lista para mostrar o item selecionado
                loadNotasFiscaisList();
                
                showTemporaryMessage('üìÑ Nota Fiscal', `Nota Fiscal "${nota.numero}" carregada para edi√ß√£o`);
            }
        }
        
        // Fun√ß√£o para adicionar produto √† nota fiscal
        function adicionarProdutoNF() {
            const produtoSelect = document.getElementById('nfProduto');
            const quantidadeInput = document.getElementById('nfQuantidade');
            const precoInput = document.getElementById('nfPrecoUnitario');
            
            const produtoId = produtoSelect.value;
            const produtoNome = produtoSelect.selectedOptions[0]?.text;
            const quantidade = parseInt(quantidadeInput.value) || 1;
            const precoUnitario = parseFloat(precoInput.value) || 0;
            
            if (!produtoId || !produtoNome || precoUnitario <= 0) {
                alert('Por favor, selecione um produto, quantidade e pre√ßo v√°lidos');
                return;
            }
            
            // Verificar se produto j√° existe na lista
            const produtoExistente = produtosNFAtual.find(p => p.id == produtoId);
            if (produtoExistente) {
                // Atualizar quantidade e pre√ßo
                produtoExistente.quantidade += quantidade;
                produtoExistente.precoUnitario = precoUnitario;
                produtoExistente.subtotal = produtoExistente.quantidade * precoUnitario;
            } else {
                // Adicionar novo produto
                const novoProduto = {
                    id: parseInt(produtoId),
                    nome: produtoNome,
                    quantidade: quantidade,
                    precoUnitario: precoUnitario,
                    subtotal: quantidade * precoUnitario
                };
                produtosNFAtual.push(novoProduto);
            }
            
            // Limpar campos
            produtoSelect.value = '';
            quantidadeInput.value = '1';
            precoInput.value = '';
            
            // Atualizar lista e total
            updateProdutosNFLista();
            calcularTotalNF();
            
            showTemporaryMessage('üõí Produto', 'Produto adicionado √† nota fiscal');
        }
        
        // Fun√ß√£o para atualizar a lista de produtos da nota fiscal
        function updateProdutosNFLista() {
            const lista = document.getElementById('produtosNFLista');
            
            if (produtosNFAtual.length === 0) {
                lista.innerHTML = '<p style="color: #6c757d; font-style: italic; margin: 10px 0;">Nenhum produto adicionado</p>';
                return;
            }
            
            const produtosHTML = produtosNFAtual.map((produto, index) => `
                <div class="produto-nf-item" style="display: flex; justify-content: space-between; align-items: center; padding: 8px; border: 1px solid #dee2e6; border-radius: 4px; margin: 5px 0; background: #f8f9fa;">
                    <div>
                        <strong>${produto.nome}</strong><br>
                        <small>Qtd: ${produto.quantidade} | Pre√ßo: R$ ${produto.precoUnitario.toFixed(2).replace('.', ',')} | Subtotal: R$ ${produto.subtotal.toFixed(2).replace('.', ',')}</small>
                    </div>
                    <button type="button" onclick="removerProdutoNF(${index})" style="background: #dc3545; color: white; border: none; border-radius: 4px; padding: 4px 8px; cursor: pointer;">üóëÔ∏è</button>
                </div>
            `).join('');
            
            lista.innerHTML = produtosHTML;
        }
        
        // Fun√ß√£o para remover produto da nota fiscal
        function removerProdutoNF(index) {
            produtosNFAtual.splice(index, 1);
            updateProdutosNFLista();
            calcularTotalNF();
            showTemporaryMessage('üóëÔ∏è Produto', 'Produto removido da nota fiscal');
        }
        
        // Fun√ß√£o para calcular total da nota fiscal
        function calcularTotalNF() {
            const total = produtosNFAtual.reduce((sum, produto) => sum + produto.subtotal, 0);
            document.getElementById('nfValor').value = total.toFixed(2);
        }
        
        function salvarNotaFiscal() {
            const numero = document.getElementById('nfNumero').value;
            const serie = document.getElementById('nfSerie').value;
            const tipo = document.getElementById('nfTipo').value;
            const operacao = document.getElementById('nfOperacao').value;
            const clienteId = document.getElementById('nfCliente').value;
            const dataEmissao = document.getElementById('nfDataEmissao').value;
            const status = document.getElementById('nfStatus').value;
            const observacoes = document.getElementById('nfObservacoes').value;
            
            if (!numero || !serie || !tipo || !operacao || !clienteId || !dataEmissao) {
                alert('Por favor, preencha os campos obrigat√≥rios: N√∫mero, S√©rie, Tipo, Opera√ß√£o, Cliente e Data de Emiss√£o');
                return;
            }
            
            if (produtosNFAtual.length === 0) {
                alert('Por favor, adicione pelo menos um produto √† nota fiscal');
                return;
            }
            
            const clienteSelect = document.getElementById('nfCliente');
            const total = produtosNFAtual.reduce((sum, produto) => sum + produto.subtotal, 0);
            
            const notaFiscalData = {
                numero,
                serie,
                tipo,
                operacao,
                cliente: {
                    id: parseInt(clienteId),
                    nome: clienteSelect.selectedOptions[0]?.text || 'Cliente'
                },
                dataEmissao,
                status: status || 'rascunho',
                observacoes,
                produtos: [...produtosNFAtual],
                total,
                chaveAcesso: generateChaveAcesso()
            };
            
            if (selectedNotaFiscalId) {
                // Editar nota fiscal existente
                const index = notasFiscaisMock.findIndex(n => n.id === selectedNotaFiscalId);
                if (index !== -1) {
                    notasFiscaisMock[index] = { ...notasFiscaisMock[index], ...notaFiscalData };
                    showTemporaryMessage('üìÑ Nota Fiscal', 'Nota Fiscal atualizada com sucesso!');
                }
            } else {
                // Criar nova nota fiscal
                const novoId = Math.max(...notasFiscaisMock.map(n => n.id)) + 1;
                notasFiscaisMock.push({ id: novoId, ...notaFiscalData });
                showTemporaryMessage('üìÑ Nota Fiscal', 'Nota Fiscal cadastrada com sucesso!');
            }
            
            // Limpar sele√ß√£o e voltar para listagem
            selectedNotaFiscalId = null;
            produtosNFAtual = [];
            limparFormNotaFiscal();
            switchNotaFiscalTab('listagem');
        }
        
        // Fun√ß√£o para gerar chave de acesso simulada
        function generateChaveAcesso() {
            const timestamp = Date.now().toString().slice(-10);
            const random = Math.random().toString().slice(2, 12);
            return `35240812345678000190550010${timestamp}${random}`;
        }
        
        function novaNotaFiscal() {
            selectedNotaFiscalId = null;
            produtosNFAtual = [];
            limparFormNotaFiscal();
            switchNotaFiscalTab('cadastro');
            // Auto-gerar n√∫mero da nota fiscal
            const proximoNumero = String(Math.max(...notasFiscaisMock.map(n => parseInt(n.numero))) + 1).padStart(6, '0');
            document.getElementById('nfNumero').value = proximoNumero;
            document.getElementById('nfSerie').value = '1';
            document.getElementById('nfDataEmissao').value = new Date().toISOString().split('T')[0];
            showTemporaryMessage('‚ûï Nova', 'Formul√°rio preparado para nova nota fiscal');
        }
        
        function limparFormNotaFiscal() {
            document.getElementById('nfNumero').value = '';
            document.getElementById('nfSerie').value = '';
            document.getElementById('nfTipo').value = '';
            document.getElementById('nfOperacao').value = '';
            document.getElementById('nfCliente').value = '';
            document.getElementById('nfDataEmissao').value = '';
            document.getElementById('nfValor').value = '';
            document.getElementById('nfStatus').value = '';
            document.getElementById('nfObservacoes').value = '';
            
            // Limpar produtos da nota fiscal
            produtosNFAtual = [];
            updateProdutosNFLista();
            
            selectedNotaFiscalId = null;
            loadNotasFiscaisList(); // Atualizar lista para remover sele√ß√£o
        }
        
        // Fun√ß√µes do m√≥dulo Transportadoras
        function salvarTransportadora() {
            const nome = document.getElementById('transpNome').value;
            const cnpj = document.getElementById('transpCnpj').value;
            
            if (!nome || !cnpj) {
                alert('Por favor, preencha os campos obrigat√≥rios: Nome e CNPJ');
                return;
            }
            
            console.log('Salvando transportadora:', { nome, cnpj });
            showTemporaryMessage('üöö Transportadora', 'Transportadora salva com sucesso!');
        }
        
        function consultarFrete() {
            showTemporaryMessage('üìã Frete', 'Funcionalidade de consulta de frete em desenvolvimento');
        }
        
        function verHistorico() {
            showTemporaryMessage('üìä Hist√≥rico', 'Funcionalidade de hist√≥rico em desenvolvimento');
        }
        
        // Mock data para usu√°rios
        let usuariosMock = [
            {
                id: 1,
                nome: "Jo√£o Silva",
                login: "joao.silva",
                email: "joao@example.com",
                perfil: "admin",
                status: "ativo",
                observacoes: "Administrador principal do sistema. Acesso total √†s funcionalidades.",
                dataUltimoAcesso: "2024-08-08",
                horaUltimoAcesso: "09:30"
            },
            {
                id: 2,
                nome: "Maria Santos",
                login: "maria.santos",
                email: "maria@example.com",
                perfil: "vendedor",
                status: "ativo",
                observacoes: "Vendedora s√™nior com foco em grandes contas. Excelente hist√≥rico de vendas.",
                dataUltimoAcesso: "2024-08-08",
                horaUltimoAcesso: "10:15"
            },
            {
                id: 3,
                nome: "Pedro Oliveira",
                login: "pedro.oliveira",
                email: "pedro@example.com",
                perfil: "operador",
                status: "inativo",
                observacoes: "Operador de sistema. Respons√°vel pela entrada de dados e relat√≥rios b√°sicos.",
                dataUltimoAcesso: "2024-08-05",
                horaUltimoAcesso: "16:45"
            },
            {
                id: 4,
                nome: "Ana Costa",
                login: "ana.costa",
                email: "ana@example.com",
                perfil: "vendedor",
                status: "ativo",
                observacoes: "Vendedora junior. Em treinamento para atendimento de clientes corporativos.",
                dataUltimoAcesso: "2024-08-08",
                horaUltimoAcesso: "08:45"
            },
            {
                id: 5,
                nome: "Carlos Admin",
                login: "carlos.admin",
                email: "carlos@example.com",
                perfil: "admin",
                status: "bloqueado",
                observacoes: "Conta bloqueada temporariamente por suspeita de acesso n√£o autorizado.",
                dataUltimoAcesso: "2024-08-03",
                horaUltimoAcesso: "22:30"
            }
        ];
        
        let selectedUsuarioId = null;
        
        // Fun√ß√£o para alternar entre abas dos usu√°rios
        function switchUsuarioTab(tab) {
            // Atualizar bot√µes das abas
            const tabButtons = document.querySelectorAll('#usuariosCard .tab-btn');
            tabButtons.forEach(btn => btn.classList.remove('active'));
            
            // Atualizar conte√∫do das abas
            const tabContents = document.querySelectorAll('#usuariosCard .tab-content');
            tabContents.forEach(content => content.classList.remove('active'));
            
            if (tab === 'listagem') {
                tabButtons[0].classList.add('active');
                document.getElementById('usuarioListagem').classList.add('active');
                loadUsuariosList();
            } else if (tab === 'cadastro') {
                tabButtons[1].classList.add('active');
                document.getElementById('usuarioCadastro').classList.add('active');
            }
        }
        
        // Fun√ß√£o para carregar a lista de usu√°rios
        function loadUsuariosList() {
            const usuariosList = document.getElementById('usuariosList');
            
            if (usuariosMock.length === 0) {
                usuariosList.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: #6c757d;">
                        <h4>üë§ Nenhum usu√°rio cadastrado</h4>
                        <p>Clique em "Cadastro/Edi√ß√£o" para criar o primeiro usu√°rio.</p>
                    </div>
                `;
                return;
            }
            
            const usuariosHTML = usuariosMock.map(usuario => `
                <div class="item-row ${selectedUsuarioId === usuario.id ? 'selected' : ''}" 
                     onclick="selectUsuario(${usuario.id})">
                    <div class="item-info">
                        <div class="item-name">${usuario.nome} (${usuario.login})</div>
                        <div class="item-details">
                            üìß ${usuario.email} | 
                            üë§ ${getPerfilName(usuario.perfil)} | 
                            üïí √öltimo acesso: ${formatDate(usuario.dataUltimoAcesso)} √†s ${usuario.horaUltimoAcesso}
                        </div>
                    </div>
                    <div class="item-status">
                        <span class="${getStatusUsuarioClass(usuario.status)}">
                            ${getStatusUsuarioIcon(usuario.status)} ${getStatusUsuarioName(usuario.status)}
                        </span>
                    </div>
                </div>
            `).join('');
            
            usuariosList.innerHTML = usuariosHTML;
        }
        
        // Fun√ß√µes auxiliares para perfis e status
        function getPerfilName(perfil) {
            const perfis = {
                'admin': 'Administrador',
                'vendedor': 'Vendedor',
                'operador': 'Operador',
                'consulta': 'Apenas Consulta'
            };
            return perfis[perfil] || perfil;
        }
        
        function getStatusUsuarioName(status) {
            const statusMap = {
                'ativo': 'Ativo',
                'inativo': 'Inativo',
                'bloqueado': 'Bloqueado'
            };
            return statusMap[status] || status;
        }
        
        function getStatusUsuarioIcon(status) {
            const icons = {
                'ativo': '‚úÖ',
                'inativo': '‚ö™',
                'bloqueado': 'üö´'
            };
            return icons[status] || '‚ùì';
        }
        
        function getStatusUsuarioClass(status) {
            const classes = {
                'ativo': 'status-active',
                'inativo': 'status-inactive',
                'bloqueado': 'status-warning'
            };
            return classes[status] || 'status-inactive';
        }
        
        // Fun√ß√£o para selecionar um usu√°rio da lista
        function selectUsuario(usuarioId) {
            selectedUsuarioId = usuarioId;
            const usuario = usuariosMock.find(u => u.id === usuarioId);
            
            if (usuario) {
                // Preencher o formul√°rio com os dados do usu√°rio
                document.getElementById('usuarioNome').value = usuario.nome;
                document.getElementById('usuarioLogin').value = usuario.login;
                document.getElementById('usuarioEmail').value = usuario.email;
                document.getElementById('usuarioPerfil').value = usuario.perfil;
                document.getElementById('usuarioStatus').value = usuario.status;
                document.getElementById('usuarioObservacoes').value = usuario.observacoes;
                
                // Limpar campo de senha por seguran√ßa
                document.getElementById('usuarioSenha').value = '';
                
                // Selecionar o usu√°rio no spinner de "Usu√°rio Conectado"
                const userSelect = document.getElementById('userSelect');
                const userData = JSON.stringify({
                    id: usuario.id,
                    name: usuario.nome,
                    email: usuario.email,
                    active: usuario.status === 'ativo'
                });
                
                // Verificar se a op√ß√£o j√° existe no select
                let optionExists = false;
                for (let option of userSelect.options) {
                    if (option.value) {
                        const existingUser = JSON.parse(option.value);
                        if (existingUser.id === usuario.id) {
                            userSelect.value = option.value;
                            optionExists = true;
                            break;
                        }
                    }
                }
                
                // Se a op√ß√£o n√£o existe, criar uma nova (caso o usu√°rio tenha sido editado)
                if (!optionExists) {
                    const newOption = new Option(`${usuario.nome} (${usuario.email})`, userData);
                    userSelect.add(newOption);
                    userSelect.value = userData;
                }
                
                // Disparar o evento de mudan√ßa para atualizar a interface
                selectUser();
                
                // Alternar para a aba de cadastro
                switchUsuarioTab('cadastro');
                
                // Atualizar a lista para mostrar o item selecionado
                loadUsuariosList();
                
                showTemporaryMessage('üë§ Usu√°rio', `Usu√°rio "${usuario.nome}" carregado para edi√ß√£o e conectado ao sistema`);
            }
        }
        
        function salvarUsuario() {
            const nome = document.getElementById('usuarioNome').value;
            const login = document.getElementById('usuarioLogin').value;
            const email = document.getElementById('usuarioEmail').value;
            const senha = document.getElementById('usuarioSenha').value;
            const perfil = document.getElementById('usuarioPerfil').value;
            const status = document.getElementById('usuarioStatus').value;
            const observacoes = document.getElementById('usuarioObservacoes').value;
            
            if (!nome || !login || !email || !perfil) {
                alert('Por favor, preencha os campos obrigat√≥rios: Nome, Login, E-mail e Perfil');
                return;
            }
            
            // Verificar se o login j√° existe (exceto para o usu√°rio atual)
            const loginExistente = usuariosMock.find(u => u.login === login && u.id !== selectedUsuarioId);
            if (loginExistente) {
                alert('Este login j√° est√° em uso por outro usu√°rio');
                return;
            }
            
            // Verificar se o email j√° existe (exceto para o usu√°rio atual)
            const emailExistente = usuariosMock.find(u => u.email === email && u.id !== selectedUsuarioId);
            if (emailExistente) {
                alert('Este e-mail j√° est√° em uso por outro usu√°rio');
                return;
            }
            
            const usuarioData = {
                nome,
                login,
                email,
                perfil,
                status: status || 'ativo',
                observacoes,
                dataUltimoAcesso: new Date().toISOString().split('T')[0],
                horaUltimoAcesso: new Date().toTimeString().slice(0, 5)
            };
            
            if (selectedUsuarioId) {
                // Editar usu√°rio existente
                const index = usuariosMock.findIndex(u => u.id === selectedUsuarioId);
                if (index !== -1) {
                    usuariosMock[index] = { ...usuariosMock[index], ...usuarioData };
                    showTemporaryMessage('üë§ Usu√°rio', 'Usu√°rio atualizado com sucesso!');
                }
            } else {
                // Criar novo usu√°rio
                if (!senha) {
                    alert('Por favor, digite uma senha para o novo usu√°rio');
                    return;
                }
                const novoId = Math.max(...usuariosMock.map(u => u.id)) + 1;
                usuariosMock.push({ id: novoId, ...usuarioData });
                showTemporaryMessage('üë§ Usu√°rio', 'Usu√°rio cadastrado com sucesso!');
            }
            
            // Limpar sele√ß√£o e voltar para listagem
            selectedUsuarioId = null;
            limparFormUsuario();
            switchUsuarioTab('listagem');
        }
        
        function novoUsuario() {
            selectedUsuarioId = null;
            limparFormUsuario();
            switchUsuarioTab('cadastro');
            showTemporaryMessage('‚ûï Novo', 'Formul√°rio preparado para novo usu√°rio');
        }
        
        function limparFormUsuario() {
            document.getElementById('usuarioNome').value = '';
            document.getElementById('usuarioLogin').value = '';
            document.getElementById('usuarioEmail').value = '';
            document.getElementById('usuarioSenha').value = '';
            document.getElementById('usuarioPerfil').value = '';
            document.getElementById('usuarioStatus').value = '';
            document.getElementById('usuarioObservacoes').value = '';
            
            selectedUsuarioId = null;
            loadUsuariosList(); // Atualizar lista para remover sele√ß√£o
        }
        
        // Fun√ß√µes do m√≥dulo Notas Fiscais
        function emitirNF() {
            const tipo = document.getElementById('nfTipo').value;
            const operacao = document.getElementById('nfOperacao').value;
            const cliente = document.getElementById('nfCliente').value;
            
            if (!tipo || !operacao || !cliente) {
                alert('Por favor, preencha os campos obrigat√≥rios: Tipo, Opera√ß√£o e Cliente');
                return;
            }
            
            console.log('Emitindo NF');
            showTemporaryMessage('üì§ Nota Fiscal', 'Nota Fiscal emitida com sucesso!');
        }
        
        function visualizarNF() {
            showTemporaryMessage('üëÅÔ∏è Visualiza√ß√£o', 'Funcionalidade de visualiza√ß√£o em desenvolvimento');
        }
        
        function cancelarNF() {
            const confirmar = confirm('Tem certeza que deseja cancelar esta Nota Fiscal?');
            if (confirmar) {
                showTemporaryMessage('‚ùå Cancelamento', 'Nota Fiscal cancelada');
            }
        }
        
        // Fun√ß√µes do m√≥dulo Usu√°rios
        function salvarUsuario() {
            const nome = document.getElementById('usuarioNome').value;
            const login = document.getElementById('usuarioLogin').value;
            const email = document.getElementById('usuarioEmail').value;
            const perfil = document.getElementById('usuarioPerfil').value;
            
            if (!nome || !login || !email || !perfil) {
                alert('Por favor, preencha os campos obrigat√≥rios: Nome, Login, E-mail e Perfil');
                return;
            }
            
            console.log('Salvando usu√°rio:', { nome, login, email, perfil });
            showTemporaryMessage('üë§ Usu√°rio', 'Usu√°rio salvo com sucesso!');
        }
        
        function resetarSenha() {
            const login = document.getElementById('usuarioLogin').value;
            if (!login) {
                alert('Digite o login do usu√°rio para resetar a senha');
                return;
            }
            
            const confirmar = confirm(`Confirma o reset da senha do usu√°rio: ${login}?`);
            if (confirmar) {
                showTemporaryMessage('üîë Reset', 'Senha resetada com sucesso!');
            }
        }
        
        function bloquearUsuario() {
            const login = document.getElementById('usuarioLogin').value;
            if (!login) {
                alert('Digite o login do usu√°rio para bloquear');
                return;
            }
            
            const confirmar = confirm(`Confirma o bloqueio do usu√°rio: ${login}?`);
            if (confirmar) {
                document.getElementById('usuarioStatus').value = 'bloqueado';
                showTemporaryMessage('üö´ Bloqueio', 'Usu√°rio bloqueado com sucesso!');
            }
        }
        
        // Fun√ß√µes do m√≥dulo Empresa
        function salvarEmpresa() {
            const nome = document.getElementById('empresaNome').value;
            const cnpj = document.getElementById('empresaCnpj').value;
            
            if (!nome || !cnpj) {
                alert('Por favor, preencha os campos obrigat√≥rios: Raz√£o Social e CNPJ');
                return;
            }
            
            console.log('Salvando dados da empresa:', { nome, cnpj });
            showTemporaryMessage('üè¢ Empresa', 'Dados da empresa salvos com sucesso!');
        }
        
        function consultarCNPJ() {
            const cnpj = document.getElementById('empresaCnpj').value;
            if (!cnpj) {
                alert('Digite o CNPJ para consultar');
                return;
            }
            
            console.log('Consultando CNPJ:', cnpj);
            showTemporaryMessage('üîç Consulta', 'Funcionalidade de consulta CNPJ em desenvolvimento');
        }
        
        function gerarRelatorio() {
            console.log('Gerando relat√≥rio da empresa');
            showTemporaryMessage('üìä Relat√≥rio', 'Funcionalidade de relat√≥rios em desenvolvimento');
        }
        
        // Fun√ß√£o para voltar ao menu principal
        function voltarAoMenu() {
            console.log('Voltando ao menu principal');
            
            // Ocultar todos os cards espec√≠ficos
            hideAllCards();
            
            // Mostrar cards comuns (user e navigation)
            showCommonCards();
            
            // Scroll para o topo
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Feedback visual
            showTemporaryMessage('üîô Navega√ß√£o', 'Voltando ao menu principal');
        }
    </script>
</body>
</html>
